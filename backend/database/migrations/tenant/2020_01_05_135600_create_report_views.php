<?php

use DB;
use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateTargetsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        $sql = <<<SQL
CREATE VIEW `qboaccountunion1` AS select `qboaccountimporta`.`accountnumber` AS `accountnumber`,`qboaccountimporta`.`account` AS `account`,`qboaccountimporta`.`type` AS `type`,`qboaccountimporta`.`detailtype` AS `detailtype`,`qboaccountimporta`.`description` AS `description`,`qboaccountimporta`.`balance` AS `balance` from `qboaccountimporta` union all select `qboaccountimportb`.`accountnumber` AS `accountnumber`,`qboaccountimportb`.`account` AS `account`,`qboaccountimportb`.`type` AS `type`,`qboaccountimportb`.`detailtype` AS `detailtype`,`qboaccountimportb`.`description` AS `description`,`qboaccountimportb`.`balance` AS `balance` from `qboaccountimportb` union all select `qboaccountimportc`.`accountnumber` AS `accountnumber`,`qboaccountimportc`.`account` AS `account`,`qboaccountimportc`.`type` AS `type`,`qboaccountimportc`.`detailtype` AS `detailtype`,`qboaccountimportc`.`description` AS `description`,`qboaccountimportc`.`balance` AS `balance` from `qboaccountimportc` union all select `qboaccountimportd`.`accountnumber` AS `accountnumber`,`qboaccountimportd`.`account` AS `account`,`qboaccountimportd`.`type` AS `type`,`qboaccountimportd`.`detailtype` AS `detailtype`,`qboaccountimportd`.`description` AS `description`,`qboaccountimportd`.`balance` AS `balance` from `qboaccountimportd` union all select `qboaccountimporte`.`accountnumber` AS `accountnumber`,`qboaccountimporte`.`account` AS `account`,`qboaccountimporte`.`type` AS `type`,`qboaccountimporte`.`detailtype` AS `detailtype`,`qboaccountimporte`.`description` AS `description`,`qboaccountimporte`.`balance` AS `balance` from `qboaccountimporte`;
CREATE VIEW `qboaccountunion2` AS select if((`qboaccountunion1`.`accountnumber` = 0),`qboaccountunion1`.`account`,concat(`qboaccountunion1`.`accountnumber`,' ',`qboaccountunion1`.`account`)) AS `accountid`,`qboaccountunion1`.`accountnumber` AS `accountnumber`,`qboaccountunion1`.`account` AS `account`,`qboaccountunion1`.`type` AS `type`,0 AS `detailtype`,0 AS `description`,0 AS `balance` from `qboaccountunion1`;
CREATE VIEW `qboaccountgroup` AS select `qboaccountunion2`.`accountid` AS `accountid`,`qboaccountunion2`.`accountnumber` AS `accountnumber`,`qboaccountunion2`.`account` AS `account`,`qboaccountunion2`.`type` AS `type`,`qboaccountunion2`.`detailtype` AS `detailtype`,`qboaccountunion2`.`description` AS `description`,`qboaccountunion2`.`balance` AS `balance` from `qboaccountunion2` group by `qboaccountunion2`.`accountid`,`qboaccountunion2`.`accountnumber`,`qboaccountunion2`.`account`,`qboaccountunion2`.`type`,`qboaccountunion2`.`detailtype`,`qboaccountunion2`.`description`,`qboaccountunion2`.`balance`;
CREATE VIEW `accountfinal` AS select `qboaccountgroup`.`account` AS `account`,substring_index(substring_index(`qboaccountgroup`.`account`,':',1),':',-(1)) AS `P1`,substring_index(substring_index(`qboaccountgroup`.`account`,':',2),':',-(1)) AS `P2`,substring_index(substring_index(`qboaccountgroup`.`account`,':',3),':',-(1)) AS `P3`,substring_index(substring_index(`qboaccountgroup`.`account`,':',4),':',-(1)) AS `P4`,substring_index(substring_index(`qboaccountgroup`.`account`,':',5),':',-(1)) AS `accountfinal`,`qboaccountgroup`.`type` AS `type` from `qboaccountgroup`;
CREATE VIEW `AccountParent1` AS select `accountfinal`.`account` AS `account`,`accountfinal`.`P1` AS `P1`,`accountfinal`.`P2` AS `P2`,`accountfinal`.`P3` AS `P3`,`accountfinal`.`P4` AS `P4`,`accountfinal`.`accountfinal` AS `accountfinal`,`accountfinal`.`type` AS `type`,if((`accountfinal`.`accountfinal` = `accountfinal`.`type`),'Ordinary Income/Expense',if((`accountfinal`.`accountfinal` = `accountfinal`.`P1`),`accountfinal`.`type`,if((`accountfinal`.`accountfinal` <> `accountfinal`.`P4`),`accountfinal`.`P4`,if((`accountfinal`.`P4` <> `accountfinal`.`P3`),`accountfinal`.`P3`,if((`accountfinal`.`P3` <> `accountfinal`.`P2`),`accountfinal`.`P2`,`accountfinal`.`P1`))))) AS `Parent`,if((`qboaccountgroup`.`accountnumber` = 0),`accountfinal`.`accountfinal`,concat(`qboaccountgroup`.`accountnumber`,' ',`accountfinal`.`accountfinal`)) AS `accountid`,`accountfinal`.`accountfinal` AS `accountdesc` from (`accountfinal` join `qboaccountgroup` on((`accountfinal`.`account` = `qboaccountgroup`.`account`))) union all select `qboaccountgroup`.`type` AS `type`,0 AS `0`,0 AS `0`,0 AS `0`,0 AS `0`,`qboaccountgroup`.`type` AS `type`,`qboaccountgroup`.`type` AS `type`,'Ordinary Income/Expense' AS `Parent`,`qboaccountgroup`.`type` AS `type`,`qboaccountgroup`.`type` AS `accountdesc` from (`qboaccountgroup` left join `accountfinal` on((`qboaccountgroup`.`type` = `accountfinal`.`account`))) where isnull(`accountfinal`.`account`) group by `qboaccountgroup`.`type`,'Ordinary Income/Expense',`qboaccountgroup`.`type`;
CREATE VIEW `Parent1` AS select `AccountParent1`.`Parent` AS `Parent` from `AccountParent1` group by `AccountParent1`.`Parent`;
CREATE VIEW `Parent2` AS select `Parent1`.`Parent` AS `Parent`,`AccountParent1`.`accountid` AS `accountid` from (`AccountParent1` join `Parent1` on((`AccountParent1`.`accountdesc` = `Parent1`.`Parent`))) group by `Parent1`.`Parent` union all select 'Ordinary Income/Expense' AS `Name_exp_3`,'Ordinary Income/Expense' AS `Name_exp_4`;
CREATE VIEW `acct_tree_create` AS select `AccountParent1`.`accountid` AS `id`,`AccountParent1`.`accountid` AS `accountid`,`AccountParent1`.`accountid` AS `account`,`Parent2`.`accountid` AS `Parent`,'' AS `applies to`,if(isnull(`Parent1`.`Parent`),'manual','rollup') AS `acct_type`,'Income Statement' AS `Impacts`,`AccountParent1`.`accountdesc` AS `accountdesc` from ((`AccountParent1` left join `Parent1` on((`AccountParent1`.`accountdesc` = `Parent1`.`Parent`))) join `Parent2` on((`AccountParent1`.`Parent` = `Parent2`.`Parent`))) union all select 'Ordinary Income/Expense' AS `Ordinary Income/Expense`,'Ordinary Income/Expense' AS `Ordinary Income/Expense`,'Ordinary Income/Expense' AS `Ordinary Income/Expense`,'Net Income' AS `Name_exp_8`,'' AS `applies to`,'rollup' AS `rollup`,'Income Statement' AS `Income Statement`,'Ordinary Income/Expense' AS `Name_exp_12` union all select 'Net Income' AS `Net Income`,'Net Income' AS `Net Income`,'Net Income' AS `Net Income`,0 AS `Name_exp_8`,'' AS `applies to`,'rollup' AS `rollup`,'Income Statement' AS `Income Statement`,'Net Income' AS `Name_exp_18`;
CREATE VIEW `dailysales_ct_old` AS select `dailysales_test`.`fcstdesc` AS `fcstdesc`,_utf8'maple_lawn' AS `Store`,_utf8'Total Sales' AS `Acct`,sum((case when ((`dailysales_test`.`month_num` = 1) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P1`,sum((case when ((`dailysales_test`.`month_num` = 2) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P2`,sum((case when ((`dailysales_test`.`month_num` = 3) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P3`,sum((case when ((`dailysales_test`.`month_num` = 4) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P4`,sum((case when ((`dailysales_test`.`month_num` = 5) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P5`,sum((case when ((`dailysales_test`.`month_num` = 6) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P6`,sum((case when ((`dailysales_test`.`month_num` = 7) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P7`,sum((case when ((`dailysales_test`.`month_num` = 8) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P8`,sum((case when ((`dailysales_test`.`month_num` = 9) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P9`,sum((case when ((`dailysales_test`.`month_num` = 10) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P10`,sum((case when ((`dailysales_test`.`month_num` = 11) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P11`,sum((case when ((`dailysales_test`.`month_num` = 12) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P12`,sum((case when ((`dailysales_test`.`month_num` = 1) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P13`,sum((case when ((`dailysales_test`.`month_num` = 2) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P14`,sum((case when ((`dailysales_test`.`month_num` = 3) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P15`,sum((case when ((`dailysales_test`.`month_num` = 4) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P16`,sum((case when ((`dailysales_test`.`month_num` = 5) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P17`,sum((case when ((`dailysales_test`.`month_num` = 6) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P18`,sum((case when ((`dailysales_test`.`month_num` = 7) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P19`,sum((case when ((`dailysales_test`.`month_num` = 8) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P20`,sum((case when ((`dailysales_test`.`month_num` = 9) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P21`,sum((case when ((`dailysales_test`.`month_num` = 10) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P22`,sum((case when ((`dailysales_test`.`month_num` = 11) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P23`,sum((case when ((`dailysales_test`.`month_num` = 12) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P24`,sum((case when ((`dailysales_test`.`month_num` = 1) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P25`,sum((case when ((`dailysales_test`.`month_num` = 2) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P26`,sum((case when ((`dailysales_test`.`month_num` = 3) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P27`,sum((case when ((`dailysales_test`.`month_num` = 4) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P28`,sum((case when ((`dailysales_test`.`month_num` = 5) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P29`,sum((case when ((`dailysales_test`.`month_num` = 6) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P30`,sum((case when ((`dailysales_test`.`month_num` = 7) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P31`,sum((case when ((`dailysales_test`.`month_num` = 8) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P32`,sum((case when ((`dailysales_test`.`month_num` = 9) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P33`,sum((case when ((`dailysales_test`.`month_num` = 10) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P34`,sum((case when ((`dailysales_test`.`month_num` = 11) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P35`,sum((case when ((`dailysales_test`.`month_num` = 12) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P36`,sum((case when ((`dailysales_test`.`month_num` = 1) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P37`,sum((case when ((`dailysales_test`.`month_num` = 2) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P38`,sum((case when ((`dailysales_test`.`month_num` = 3) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P39`,sum((case when ((`dailysales_test`.`month_num` = 4) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P40`,sum((case when ((`dailysales_test`.`month_num` = 5) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P41`,sum((case when ((`dailysales_test`.`month_num` = 6) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P42`,sum((case when ((`dailysales_test`.`month_num` = 7) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P43`,sum((case when ((`dailysales_test`.`month_num` = 8) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P44`,sum((case when ((`dailysales_test`.`month_num` = 9) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P45`,sum((case when ((`dailysales_test`.`month_num` = 10) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P46`,sum((case when ((`dailysales_test`.`month_num` = 11) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P47`,sum((case when ((`dailysales_test`.`month_num` = 12) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P48`,sum((case when ((`dailysales_test`.`month_num` = 1) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P49`,sum((case when ((`dailysales_test`.`month_num` = 2) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P50`,sum((case when ((`dailysales_test`.`month_num` = 3) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P51`,sum((case when ((`dailysales_test`.`month_num` = 4) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P52`,sum((case when ((`dailysales_test`.`month_num` = 5) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P53`,sum((case when ((`dailysales_test`.`month_num` = 6) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P54`,sum((case when ((`dailysales_test`.`month_num` = 7) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P55`,sum((case when ((`dailysales_test`.`month_num` = 8) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P56`,sum((case when ((`dailysales_test`.`month_num` = 9) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P57`,sum((case when ((`dailysales_test`.`month_num` = 10) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P58`,sum((case when ((`dailysales_test`.`month_num` = 11) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P59`,sum((case when ((`dailysales_test`.`month_num` = 12) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`Aberdeen` else 0 end)) AS `P60` from `dailysales_test` group by `dailysales_test`.`fcstdesc`,_utf8'Aberdeen',_utf8'Total Sales' union select `dailysales_test`.`fcstdesc` AS `fcstdesc`,_utf8'perry_hall' AS `Store`,_utf8'Total Sales' AS `Acct`,sum((case when ((`dailysales_test`.`month_num` = 1) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P1`,sum((case when ((`dailysales_test`.`month_num` = 2) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P2`,sum((case when ((`dailysales_test`.`month_num` = 3) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P3`,sum((case when ((`dailysales_test`.`month_num` = 4) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P4`,sum((case when ((`dailysales_test`.`month_num` = 5) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P5`,sum((case when ((`dailysales_test`.`month_num` = 6) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P6`,sum((case when ((`dailysales_test`.`month_num` = 7) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P7`,sum((case when ((`dailysales_test`.`month_num` = 8) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P8`,sum((case when ((`dailysales_test`.`month_num` = 9) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P9`,sum((case when ((`dailysales_test`.`month_num` = 10) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P10`,sum((case when ((`dailysales_test`.`month_num` = 11) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P11`,sum((case when ((`dailysales_test`.`month_num` = 12) and (`dailysales_test`.`year` = 2018)) then `dailysales_test`.`BelAir` else 0 end)) AS `P12`,sum((case when ((`dailysales_test`.`month_num` = 1) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P13`,sum((case when ((`dailysales_test`.`month_num` = 2) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P14`,sum((case when ((`dailysales_test`.`month_num` = 3) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P15`,sum((case when ((`dailysales_test`.`month_num` = 4) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P16`,sum((case when ((`dailysales_test`.`month_num` = 5) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P17`,sum((case when ((`dailysales_test`.`month_num` = 6) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P18`,sum((case when ((`dailysales_test`.`month_num` = 7) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P19`,sum((case when ((`dailysales_test`.`month_num` = 8) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P20`,sum((case when ((`dailysales_test`.`month_num` = 9) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P21`,sum((case when ((`dailysales_test`.`month_num` = 10) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P22`,sum((case when ((`dailysales_test`.`month_num` = 11) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P23`,sum((case when ((`dailysales_test`.`month_num` = 12) and (`dailysales_test`.`year` = 2019)) then `dailysales_test`.`BelAir` else 0 end)) AS `P24`,sum((case when ((`dailysales_test`.`month_num` = 1) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P25`,sum((case when ((`dailysales_test`.`month_num` = 2) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P26`,sum((case when ((`dailysales_test`.`month_num` = 3) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P27`,sum((case when ((`dailysales_test`.`month_num` = 4) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P28`,sum((case when ((`dailysales_test`.`month_num` = 5) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P29`,sum((case when ((`dailysales_test`.`month_num` = 6) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P30`,sum((case when ((`dailysales_test`.`month_num` = 7) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P31`,sum((case when ((`dailysales_test`.`month_num` = 8) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P32`,sum((case when ((`dailysales_test`.`month_num` = 9) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P33`,sum((case when ((`dailysales_test`.`month_num` = 10) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P34`,sum((case when ((`dailysales_test`.`month_num` = 11) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P35`,sum((case when ((`dailysales_test`.`month_num` = 12) and (`dailysales_test`.`year` = 2020)) then `dailysales_test`.`BelAir` else 0 end)) AS `P36`,sum((case when ((`dailysales_test`.`month_num` = 1) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P37`,sum((case when ((`dailysales_test`.`month_num` = 2) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P38`,sum((case when ((`dailysales_test`.`month_num` = 3) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P39`,sum((case when ((`dailysales_test`.`month_num` = 4) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P40`,sum((case when ((`dailysales_test`.`month_num` = 5) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P41`,sum((case when ((`dailysales_test`.`month_num` = 6) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P42`,sum((case when ((`dailysales_test`.`month_num` = 7) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P43`,sum((case when ((`dailysales_test`.`month_num` = 8) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P44`,sum((case when ((`dailysales_test`.`month_num` = 9) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P45`,sum((case when ((`dailysales_test`.`month_num` = 10) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P46`,sum((case when ((`dailysales_test`.`month_num` = 11) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P47`,sum((case when ((`dailysales_test`.`month_num` = 12) and (`dailysales_test`.`year` = 2021)) then `dailysales_test`.`BelAir` else 0 end)) AS `P48`,sum((case when ((`dailysales_test`.`month_num` = 1) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P49`,sum((case when ((`dailysales_test`.`month_num` = 2) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P50`,sum((case when ((`dailysales_test`.`month_num` = 3) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P51`,sum((case when ((`dailysales_test`.`month_num` = 4) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P52`,sum((case when ((`dailysales_test`.`month_num` = 5) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P53`,sum((case when ((`dailysales_test`.`month_num` = 6) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P54`,sum((case when ((`dailysales_test`.`month_num` = 7) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P55`,sum((case when ((`dailysales_test`.`month_num` = 8) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P56`,sum((case when ((`dailysales_test`.`month_num` = 9) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P57`,sum((case when ((`dailysales_test`.`month_num` = 10) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P58`,sum((case when ((`dailysales_test`.`month_num` = 11) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P59`,sum((case when ((`dailysales_test`.`month_num` = 12) and (`dailysales_test`.`year` = 2022)) then `dailysales_test`.`BelAir` else 0 end)) AS `P60` from `dailysales_test` group by `dailysales_test`.`fcstdesc`,_utf8'BelAir',_utf8'Total Sales';
CREATE VIEW `dailysales_ct` AS select `dailysales_ct_old`.`fcstdesc` AS `FCSTDesc`,`dailysales_ct_old`.`Store` AS `Store`,`dailysales_ct_old`.`Acct` AS `Acct`,`dailysales_ct_old`.`P1` AS `P1`,`dailysales_ct_old`.`P2` AS `P2`,`dailysales_ct_old`.`P3` AS `P3`,`dailysales_ct_old`.`P4` AS `P4`,`dailysales_ct_old`.`P5` AS `P5`,`dailysales_ct_old`.`P6` AS `P6`,`dailysales_ct_old`.`P7` AS `P7`,`dailysales_ct_old`.`P8` AS `P8`,`dailysales_ct_old`.`P9` AS `P9`,`dailysales_ct_old`.`P10` AS `P10`,`dailysales_ct_old`.`P11` AS `P11`,`dailysales_ct_old`.`P12` AS `P12`,`dailysales_ct_old`.`P13` AS `P13`,`dailysales_ct_old`.`P14` AS `P14`,`dailysales_ct_old`.`P15` AS `P15`,`dailysales_ct_old`.`P16` AS `P16`,`dailysales_ct_old`.`P17` AS `P17`,`dailysales_ct_old`.`P18` AS `P18`,`dailysales_ct_old`.`P19` AS `P19`,`dailysales_ct_old`.`P20` AS `P20`,`dailysales_ct_old`.`P21` AS `P21`,`dailysales_ct_old`.`P22` AS `P22`,`dailysales_ct_old`.`P23` AS `P23`,`dailysales_ct_old`.`P24` AS `P24`,`dailysales_ct_old`.`P25` AS `P25`,`dailysales_ct_old`.`P26` AS `P26`,`dailysales_ct_old`.`P27` AS `P27`,`dailysales_ct_old`.`P28` AS `P28`,`dailysales_ct_old`.`P29` AS `P29`,`dailysales_ct_old`.`P30` AS `P30`,`dailysales_ct_old`.`P31` AS `P31`,`dailysales_ct_old`.`P32` AS `P32`,`dailysales_ct_old`.`P33` AS `P33`,`dailysales_ct_old`.`P34` AS `P34`,`dailysales_ct_old`.`P35` AS `P35`,`dailysales_ct_old`.`P36` AS `P36`,`dailysales_ct_old`.`P37` AS `P37`,`dailysales_ct_old`.`P38` AS `P38`,`dailysales_ct_old`.`P39` AS `P39`,`dailysales_ct_old`.`P40` AS `P40`,`dailysales_ct_old`.`P41` AS `P41`,`dailysales_ct_old`.`P42` AS `P42`,`dailysales_ct_old`.`P43` AS `P43`,`dailysales_ct_old`.`P44` AS `P44`,`dailysales_ct_old`.`P45` AS `P45`,`dailysales_ct_old`.`P46` AS `P46`,`dailysales_ct_old`.`P47` AS `P47`,`dailysales_ct_old`.`P48` AS `P48`,`dailysales_ct_old`.`P49` AS `P49`,`dailysales_ct_old`.`P50` AS `P50`,`dailysales_ct_old`.`P51` AS `P51`,`dailysales_ct_old`.`P52` AS `P52`,`dailysales_ct_old`.`P53` AS `P53`,`dailysales_ct_old`.`P54` AS `P54`,`dailysales_ct_old`.`P55` AS `P55`,`dailysales_ct_old`.`P56` AS `P56`,`dailysales_ct_old`.`P57` AS `P57`,`dailysales_ct_old`.`P58` AS `P58`,`dailysales_ct_old`.`P59` AS `P59`,`dailysales_ct_old`.`P60` AS `P60` from `dailysales_ct_old`;
CREATE VIEW `dailysales_ct_FCST` AS select `dailysales_ct_old`.`fcstdesc` AS `FCSTDesc`,`dailysales_ct_old`.`Store` AS `Store`,`dailysales_ct_old`.`Acct` AS `Acct`,`dailysales_ct_old`.`P1` AS `P1`,`dailysales_ct_old`.`P2` AS `P2`,`dailysales_ct_old`.`P3` AS `P3`,`dailysales_ct_old`.`P4` AS `P4`,`dailysales_ct_old`.`P5` AS `P5`,`dailysales_ct_old`.`P6` AS `P6`,`dailysales_ct_old`.`P7` AS `P7`,`dailysales_ct_old`.`P8` AS `P8`,`dailysales_ct_old`.`P9` AS `P9`,`dailysales_ct_old`.`P10` AS `P10`,`dailysales_ct_old`.`P11` AS `P11`,`dailysales_ct_old`.`P12` AS `P12`,`dailysales_ct_old`.`P13` AS `P13`,`dailysales_ct_old`.`P14` AS `P14`,`dailysales_ct_old`.`P15` AS `P15`,`dailysales_ct_old`.`P16` AS `P16`,`dailysales_ct_old`.`P17` AS `P17`,`dailysales_ct_old`.`P18` AS `P18`,`dailysales_ct_old`.`P19` AS `P19`,`dailysales_ct_old`.`P20` AS `P20`,`dailysales_ct_old`.`P21` AS `P21`,`dailysales_ct_old`.`P22` AS `P22`,`dailysales_ct_old`.`P23` AS `P23`,`dailysales_ct_old`.`P24` AS `P24`,`dailysales_ct_old`.`P25` AS `P25`,`dailysales_ct_old`.`P26` AS `P26`,`dailysales_ct_old`.`P27` AS `P27`,`dailysales_ct_old`.`P28` AS `P28`,`dailysales_ct_old`.`P29` AS `P29`,`dailysales_ct_old`.`P30` AS `P30`,`dailysales_ct_old`.`P31` AS `P31`,`dailysales_ct_old`.`P32` AS `P32`,`dailysales_ct_old`.`P33` AS `P33`,`dailysales_ct_old`.`P34` AS `P34`,`dailysales_ct_old`.`P35` AS `P35`,`dailysales_ct_old`.`P36` AS `P36`,`dailysales_ct_old`.`P37` AS `P37`,`dailysales_ct_old`.`P38` AS `P38`,`dailysales_ct_old`.`P39` AS `P39`,`dailysales_ct_old`.`P40` AS `P40`,`dailysales_ct_old`.`P41` AS `P41`,`dailysales_ct_old`.`P42` AS `P42`,`dailysales_ct_old`.`P43` AS `P43`,`dailysales_ct_old`.`P44` AS `P44`,`dailysales_ct_old`.`P45` AS `P45`,`dailysales_ct_old`.`P46` AS `P46`,`dailysales_ct_old`.`P47` AS `P47`,`dailysales_ct_old`.`P48` AS `P48`,`dailysales_ct_old`.`P49` AS `P49`,`dailysales_ct_old`.`P50` AS `P50`,`dailysales_ct_old`.`P51` AS `P51`,`dailysales_ct_old`.`P52` AS `P52`,`dailysales_ct_old`.`P53` AS `P53`,`dailysales_ct_old`.`P54` AS `P54`,`dailysales_ct_old`.`P55` AS `P55`,`dailysales_ct_old`.`P56` AS `P56`,`dailysales_ct_old`.`P57` AS `P57`,`dailysales_ct_old`.`P58` AS `P58`,`dailysales_ct_old`.`P59` AS `P59`,`dailysales_ct_old`.`P60` AS `P60` from `dailysales_ct_old`;
CREATE VIEW `driver_accounts` AS select `acct_tree2`.`acct_id` AS `acct_id`,`acct_tree2`.`acct` AS `acct`,`acct_tree2`.`acctdesc` AS `acctdesc`,`acct_tree2`.`parent` AS `parent`,`acct_tree2`.`applies_to` AS `applies_to`,`acct_tree2`.`acct_type` AS `acct_type`,`acct_tree2`.`impacts` AS `impacts`,`acct_tree2`.`sort` AS `sort` from `acct_tree2` where (`acct_tree2`.`acct_type` not in (_latin1'manual',_latin1'legacy',_latin1'rollup'));
CREATE VIEW `drivers_calc` AS select `drivers_rates`.`AccountDriver1` AS `Driver`,`drivers_rates`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_manual`.`Mid4Desc` AS `Store`,`drivers_rates`.`Account` AS `Account`,`drivers_rates`.`Account_map` AS `Account_map`,0 AS `P1`,0 AS `P2`,0 AS `P3`,0 AS `P4`,0 AS `P5`,0 AS `P6`,0 AS `P7`,0 AS `P8`,0 AS `P9`,0 AS `P10`,0 AS `P11`,0 AS `P12`,0 AS `P13`,0 AS `P14`,0 AS `P15`,0 AS `P16`,0 AS `P17`,0 AS `P18`,0 AS `P19`,0 AS `P20`,0 AS `P21`,0 AS `P22`,0 AS `P23`,0 AS `P24`,(`master_fcst_manual`.`P25` * `drivers_rates`.`P25`) AS `P25`,(`master_fcst_manual`.`P26` * `drivers_rates`.`P26`) AS `P26`,(`master_fcst_manual`.`P27` * `drivers_rates`.`P27`) AS `P27`,(`master_fcst_manual`.`P28` * `drivers_rates`.`P28`) AS `P28`,(`master_fcst_manual`.`P29` * `drivers_rates`.`P29`) AS `P29`,(`master_fcst_manual`.`P30` * `drivers_rates`.`P30`) AS `P30`,(`master_fcst_manual`.`P31` * `drivers_rates`.`P31`) AS `P31`,(`master_fcst_manual`.`P32` * `drivers_rates`.`P32`) AS `P32`,(`master_fcst_manual`.`P33` * `drivers_rates`.`P33`) AS `P33`,(`master_fcst_manual`.`P34` * `drivers_rates`.`P34`) AS `P34`,(`master_fcst_manual`.`P35` * `drivers_rates`.`P35`) AS `P35`,(`master_fcst_manual`.`P36` * `drivers_rates`.`P36`) AS `P36`,(`master_fcst_manual`.`P37` * `drivers_rates`.`P37`) AS `P37`,(`master_fcst_manual`.`P38` * `drivers_rates`.`P38`) AS `P38`,(`master_fcst_manual`.`P39` * `drivers_rates`.`P39`) AS `P39`,(`master_fcst_manual`.`P40` * `drivers_rates`.`P40`) AS `P40`,(`master_fcst_manual`.`P41` * `drivers_rates`.`P41`) AS `P41`,(`master_fcst_manual`.`P42` * `drivers_rates`.`P42`) AS `P42`,(`master_fcst_manual`.`P43` * `drivers_rates`.`P43`) AS `P43`,(`master_fcst_manual`.`P44` * `drivers_rates`.`P44`) AS `P44`,(`master_fcst_manual`.`P45` * `drivers_rates`.`P45`) AS `P45`,(`master_fcst_manual`.`P46` * `drivers_rates`.`P46`) AS `P46`,(`master_fcst_manual`.`P47` * `drivers_rates`.`P47`) AS `P47`,(`master_fcst_manual`.`P48` * `drivers_rates`.`P48`) AS `P48`,(`master_fcst_manual`.`P49` * `drivers_rates`.`P49`) AS `P49`,(`master_fcst_manual`.`P50` * `drivers_rates`.`P50`) AS `P50`,(`master_fcst_manual`.`P51` * `drivers_rates`.`P51`) AS `P51`,(`master_fcst_manual`.`P52` * `drivers_rates`.`P52`) AS `P52`,(`master_fcst_manual`.`P53` * `drivers_rates`.`P53`) AS `P53`,(`master_fcst_manual`.`P54` * `drivers_rates`.`P54`) AS `P54`,(`master_fcst_manual`.`P55` * `drivers_rates`.`P55`) AS `P55`,(`master_fcst_manual`.`P56` * `drivers_rates`.`P56`) AS `P56`,(`master_fcst_manual`.`P57` * `drivers_rates`.`P57`) AS `P57`,(`master_fcst_manual`.`P58` * `drivers_rates`.`P58`) AS `P58`,(`master_fcst_manual`.`P59` * `drivers_rates`.`P59`) AS `P59`,(`master_fcst_manual`.`P60` * `drivers_rates`.`P60`) AS `P60` from ((`master_fcst_manual` join `drivers_rates` on(((`master_fcst_manual`.`AccountDesc` = `drivers_rates`.`AccountDriver1`) and (`master_fcst_manual`.`FCSTDesc` = `drivers_rates`.`FCSTDesc`) and (`master_fcst_manual`.`Mid4Desc` = `drivers_rates`.`Store`)))) join `acct_tree2` on((`drivers_rates`.`AccountDriver1` = convert(`acct_tree2`.`acct` using utf8)))) where (`acct_tree2`.`acct_type` in (_latin1'manual',_latin1'legacy',_latin1'rollup')) group by `drivers_rates`.`AccountDriver1`,`drivers_rates`.`FCSTDesc`,`master_fcst_manual`.`Mid4Desc`,`drivers_rates`.`Account`,`drivers_rates`.`Account_map` union all select `drivers_rates`.`AccountDriver2` AS `Driver`,`drivers_rates`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_manual`.`Mid4Desc` AS `Mid4Desc`,`drivers_rates`.`Account` AS `Account`,`drivers_rates`.`Account_map` AS `Account_map`,0 AS `P1`,0 AS `P2`,0 AS `P3`,0 AS `P4`,0 AS `P5`,0 AS `P6`,0 AS `P7`,0 AS `P8`,0 AS `P9`,0 AS `P10`,0 AS `P11`,0 AS `P12`,0 AS `P13`,0 AS `P14`,0 AS `P15`,0 AS `P16`,0 AS `P17`,0 AS `P18`,0 AS `P19`,0 AS `P20`,0 AS `P21`,0 AS `P22`,0 AS `P23`,0 AS `P24`,(`master_fcst_manual`.`P25` * `drivers_rates`.`P25`) AS `P25`,(`master_fcst_manual`.`P26` * `drivers_rates`.`P26`) AS `P26`,(`master_fcst_manual`.`P27` * `drivers_rates`.`P27`) AS `P27`,(`master_fcst_manual`.`P28` * `drivers_rates`.`P28`) AS `P28`,(`master_fcst_manual`.`P29` * `drivers_rates`.`P29`) AS `P29`,(`master_fcst_manual`.`P30` * `drivers_rates`.`P30`) AS `P30`,(`master_fcst_manual`.`P31` * `drivers_rates`.`P31`) AS `P31`,(`master_fcst_manual`.`P32` * `drivers_rates`.`P32`) AS `P32`,(`master_fcst_manual`.`P33` * `drivers_rates`.`P33`) AS `P33`,(`master_fcst_manual`.`P34` * `drivers_rates`.`P34`) AS `P34`,(`master_fcst_manual`.`P35` * `drivers_rates`.`P35`) AS `P35`,(`master_fcst_manual`.`P36` * `drivers_rates`.`P36`) AS `P36`,(`master_fcst_manual`.`P37` * `drivers_rates`.`P37`) AS `P37`,(`master_fcst_manual`.`P38` * `drivers_rates`.`P38`) AS `P38`,(`master_fcst_manual`.`P39` * `drivers_rates`.`P39`) AS `P39`,(`master_fcst_manual`.`P40` * `drivers_rates`.`P40`) AS `P40`,(`master_fcst_manual`.`P41` * `drivers_rates`.`P41`) AS `P41`,(`master_fcst_manual`.`P42` * `drivers_rates`.`P42`) AS `P42`,(`master_fcst_manual`.`P43` * `drivers_rates`.`P43`) AS `P43`,(`master_fcst_manual`.`P44` * `drivers_rates`.`P44`) AS `P44`,(`master_fcst_manual`.`P45` * `drivers_rates`.`P45`) AS `P45`,(`master_fcst_manual`.`P46` * `drivers_rates`.`P46`) AS `P46`,(`master_fcst_manual`.`P47` * `drivers_rates`.`P47`) AS `P47`,(`master_fcst_manual`.`P48` * `drivers_rates`.`P48`) AS `P48`,(`master_fcst_manual`.`P49` * `drivers_rates`.`P49`) AS `P49`,(`master_fcst_manual`.`P50` * `drivers_rates`.`P50`) AS `P50`,(`master_fcst_manual`.`P51` * `drivers_rates`.`P51`) AS `P51`,(`master_fcst_manual`.`P52` * `drivers_rates`.`P52`) AS `P52`,(`master_fcst_manual`.`P53` * `drivers_rates`.`P53`) AS `P53`,(`master_fcst_manual`.`P54` * `drivers_rates`.`P54`) AS `P54`,(`master_fcst_manual`.`P55` * `drivers_rates`.`P55`) AS `P55`,(`master_fcst_manual`.`P56` * `drivers_rates`.`P56`) AS `P56`,(`master_fcst_manual`.`P57` * `drivers_rates`.`P57`) AS `P57`,(`master_fcst_manual`.`P58` * `drivers_rates`.`P58`) AS `P58`,(`master_fcst_manual`.`P59` * `drivers_rates`.`P59`) AS `P59`,(`master_fcst_manual`.`P60` * `drivers_rates`.`P60`) AS `P60` from ((`master_fcst_manual` join `drivers_rates` on(((`master_fcst_manual`.`AccountDesc` = `drivers_rates`.`AccountDriver2`) and (`master_fcst_manual`.`FCSTDesc` = `drivers_rates`.`FCSTDesc`) and (`master_fcst_manual`.`Mid4Desc` = `drivers_rates`.`Store`)))) join `acct_tree2` on((`drivers_rates`.`AccountDriver2` = convert(`acct_tree2`.`acct` using utf8)))) where (`acct_tree2`.`acct_type` in (_latin1'manual',_latin1'legacy',_latin1'rollup')) group by `drivers_rates`.`AccountDriver2`,`drivers_rates`.`FCSTDesc`,`master_fcst_manual`.`Mid4Desc`,`drivers_rates`.`Account`,`drivers_rates`.`Account_map` union all select `drivers_rates`.`AccountDriver3` AS `Driver`,`drivers_rates`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_manual`.`Mid4Desc` AS `Mid4Desc`,`drivers_rates`.`Account` AS `Account`,`drivers_rates`.`Account_map` AS `Account_map`,0 AS `P1`,0 AS `P2`,0 AS `P3`,0 AS `P4`,0 AS `P5`,0 AS `P6`,0 AS `P7`,0 AS `P8`,0 AS `P9`,0 AS `P10`,0 AS `P11`,0 AS `P12`,0 AS `P13`,0 AS `P14`,0 AS `P15`,0 AS `P16`,0 AS `P17`,0 AS `P18`,0 AS `P19`,0 AS `P20`,0 AS `P21`,0 AS `P22`,0 AS `P23`,0 AS `P24`,(`master_fcst_manual`.`P25` * `drivers_rates`.`P25`) AS `P25`,(`master_fcst_manual`.`P26` * `drivers_rates`.`P26`) AS `P26`,(`master_fcst_manual`.`P27` * `drivers_rates`.`P27`) AS `P27`,(`master_fcst_manual`.`P28` * `drivers_rates`.`P28`) AS `P28`,(`master_fcst_manual`.`P29` * `drivers_rates`.`P29`) AS `P29`,(`master_fcst_manual`.`P30` * `drivers_rates`.`P30`) AS `P30`,(`master_fcst_manual`.`P31` * `drivers_rates`.`P31`) AS `P31`,(`master_fcst_manual`.`P32` * `drivers_rates`.`P32`) AS `P32`,(`master_fcst_manual`.`P33` * `drivers_rates`.`P33`) AS `P33`,(`master_fcst_manual`.`P34` * `drivers_rates`.`P34`) AS `P34`,(`master_fcst_manual`.`P35` * `drivers_rates`.`P35`) AS `P35`,(`master_fcst_manual`.`P36` * `drivers_rates`.`P36`) AS `P36`,(`master_fcst_manual`.`P37` * `drivers_rates`.`P37`) AS `P37`,(`master_fcst_manual`.`P38` * `drivers_rates`.`P38`) AS `P38`,(`master_fcst_manual`.`P39` * `drivers_rates`.`P39`) AS `P39`,(`master_fcst_manual`.`P40` * `drivers_rates`.`P40`) AS `P40`,(`master_fcst_manual`.`P41` * `drivers_rates`.`P41`) AS `P41`,(`master_fcst_manual`.`P42` * `drivers_rates`.`P42`) AS `P42`,(`master_fcst_manual`.`P43` * `drivers_rates`.`P43`) AS `P43`,(`master_fcst_manual`.`P44` * `drivers_rates`.`P44`) AS `P44`,(`master_fcst_manual`.`P45` * `drivers_rates`.`P45`) AS `P45`,(`master_fcst_manual`.`P46` * `drivers_rates`.`P46`) AS `P46`,(`master_fcst_manual`.`P47` * `drivers_rates`.`P47`) AS `P47`,(`master_fcst_manual`.`P48` * `drivers_rates`.`P48`) AS `P48`,(`master_fcst_manual`.`P49` * `drivers_rates`.`P49`) AS `P49`,(`master_fcst_manual`.`P50` * `drivers_rates`.`P50`) AS `P50`,(`master_fcst_manual`.`P51` * `drivers_rates`.`P51`) AS `P51`,(`master_fcst_manual`.`P52` * `drivers_rates`.`P52`) AS `P52`,(`master_fcst_manual`.`P53` * `drivers_rates`.`P53`) AS `P53`,(`master_fcst_manual`.`P54` * `drivers_rates`.`P54`) AS `P54`,(`master_fcst_manual`.`P55` * `drivers_rates`.`P55`) AS `P55`,(`master_fcst_manual`.`P56` * `drivers_rates`.`P56`) AS `P56`,(`master_fcst_manual`.`P57` * `drivers_rates`.`P57`) AS `P57`,(`master_fcst_manual`.`P58` * `drivers_rates`.`P58`) AS `P58`,(`master_fcst_manual`.`P59` * `drivers_rates`.`P59`) AS `P59`,(`master_fcst_manual`.`P60` * `drivers_rates`.`P60`) AS `P60` from ((`master_fcst_manual` join `drivers_rates` on(((`master_fcst_manual`.`AccountDesc` = `drivers_rates`.`AccountDriver3`) and (`master_fcst_manual`.`FCSTDesc` = `drivers_rates`.`FCSTDesc`) and (`master_fcst_manual`.`Mid4Desc` = `drivers_rates`.`Store`)))) join `acct_tree2` on((`drivers_rates`.`AccountDriver3` = convert(`acct_tree2`.`acct` using utf8)))) where (`acct_tree2`.`acct_type` in (_latin1'manual',_latin1'legacy',_latin1'rollup')) group by `drivers_rates`.`AccountDriver3`,`drivers_rates`.`FCSTDesc`,`master_fcst_manual`.`Mid4Desc`,`drivers_rates`.`Account`,`drivers_rates`.`Account_map` union all select _utf8'Total Sales' AS `Driver`,`drivers_rates`.`FCSTDesc` AS `FCSTDesc`,`dailysales_ct_FCST`.`Store` AS `store`,`drivers_rates`.`Account` AS `Account`,`drivers_rates`.`Account_map` AS `Account_map`,0 AS `P1`,0 AS `P2`,0 AS `P3`,0 AS `P4`,0 AS `P5`,0 AS `P6`,0 AS `P7`,0 AS `P8`,0 AS `P9`,0 AS `P10`,0 AS `P11`,0 AS `P12`,0 AS `P13`,0 AS `P14`,0 AS `P15`,0 AS `P16`,0 AS `P17`,0 AS `P18`,0 AS `P19`,0 AS `P20`,0 AS `P21`,0 AS `P22`,0 AS `P23`,0 AS `P24`,(`dailysales_ct_FCST`.`P25` * `drivers_rates`.`P25`) AS `P25`,(`dailysales_ct_FCST`.`P26` * `drivers_rates`.`P26`) AS `P26`,(`dailysales_ct_FCST`.`P27` * `drivers_rates`.`P27`) AS `P27`,(`dailysales_ct_FCST`.`P28` * `drivers_rates`.`P28`) AS `P28`,(`dailysales_ct_FCST`.`P29` * `drivers_rates`.`P29`) AS `P29`,(`dailysales_ct_FCST`.`P30` * `drivers_rates`.`P30`) AS `P30`,(`dailysales_ct_FCST`.`P31` * `drivers_rates`.`P31`) AS `P31`,(`dailysales_ct_FCST`.`P32` * `drivers_rates`.`P32`) AS `P32`,(`dailysales_ct_FCST`.`P33` * `drivers_rates`.`P33`) AS `P33`,(`dailysales_ct_FCST`.`P34` * `drivers_rates`.`P34`) AS `P34`,(`dailysales_ct_FCST`.`P35` * `drivers_rates`.`P35`) AS `P35`,(`dailysales_ct_FCST`.`P36` * `drivers_rates`.`P36`) AS `P36`,(`dailysales_ct_FCST`.`P37` * `drivers_rates`.`P37`) AS `P37`,(`dailysales_ct_FCST`.`P38` * `drivers_rates`.`P38`) AS `P38`,(`dailysales_ct_FCST`.`P39` * `drivers_rates`.`P39`) AS `P39`,(`dailysales_ct_FCST`.`P40` * `drivers_rates`.`P40`) AS `P40`,(`dailysales_ct_FCST`.`P41` * `drivers_rates`.`P41`) AS `P41`,(`dailysales_ct_FCST`.`P42` * `drivers_rates`.`P42`) AS `P42`,(`dailysales_ct_FCST`.`P43` * `drivers_rates`.`P43`) AS `P43`,(`dailysales_ct_FCST`.`P44` * `drivers_rates`.`P44`) AS `P44`,(`dailysales_ct_FCST`.`P45` * `drivers_rates`.`P45`) AS `P45`,(`dailysales_ct_FCST`.`P46` * `drivers_rates`.`P46`) AS `P46`,(`dailysales_ct_FCST`.`P47` * `drivers_rates`.`P47`) AS `P47`,(`dailysales_ct_FCST`.`P48` * `drivers_rates`.`P48`) AS `P48`,(`dailysales_ct_FCST`.`P49` * `drivers_rates`.`P49`) AS `P49`,(`dailysales_ct_FCST`.`P50` * `drivers_rates`.`P50`) AS `P50`,(`dailysales_ct_FCST`.`P51` * `drivers_rates`.`P51`) AS `P51`,(`dailysales_ct_FCST`.`P52` * `drivers_rates`.`P52`) AS `P52`,(`dailysales_ct_FCST`.`P53` * `drivers_rates`.`P53`) AS `P53`,(`dailysales_ct_FCST`.`P54` * `drivers_rates`.`P54`) AS `P54`,(`dailysales_ct_FCST`.`P55` * `drivers_rates`.`P55`) AS `P55`,(`dailysales_ct_FCST`.`P56` * `drivers_rates`.`P56`) AS `P56`,(`dailysales_ct_FCST`.`P57` * `drivers_rates`.`P57`) AS `P57`,(`dailysales_ct_FCST`.`P58` * `drivers_rates`.`P58`) AS `P58`,(`dailysales_ct_FCST`.`P59` * `drivers_rates`.`P59`) AS `P59`,(`dailysales_ct_FCST`.`P60` * `drivers_rates`.`P60`) AS `P60` from (`dailysales_ct_FCST` join `drivers_rates` on(((`dailysales_ct_FCST`.`Acct` = `drivers_rates`.`AccountDriver1`) and (`dailysales_ct_FCST`.`FCSTDesc` = `drivers_rates`.`FCSTDesc`) and (`dailysales_ct_FCST`.`Store` = `drivers_rates`.`Store`)))) union all select _utf8'Daily Sales' AS `Driver`,`dailysales_ct_FCST`.`FCSTDesc` AS `FCSTDesc`,`dailysales_ct_FCST`.`Store` AS `Store`,`dailysales_ct_FCST`.`Acct` AS `Account`,`dailysales_ct_FCST`.`Acct` AS `Account_map`,0 AS `P1`,0 AS `P2`,0 AS `P3`,0 AS `P4`,0 AS `P5`,0 AS `P6`,0 AS `P7`,0 AS `P8`,0 AS `P9`,0 AS `P10`,0 AS `P11`,0 AS `P12`,0 AS `P13`,0 AS `P14`,0 AS `P15`,0 AS `P16`,0 AS `P17`,0 AS `P18`,0 AS `P19`,0 AS `P20`,0 AS `P21`,0 AS `P22`,0 AS `P23`,0 AS `P24`,(`dailysales_ct_FCST`.`P25` * -(1)) AS `P25`,(`dailysales_ct_FCST`.`P26` * -(1)) AS `P26`,(`dailysales_ct_FCST`.`P27` * -(1)) AS `P27`,(`dailysales_ct_FCST`.`P28` * -(1)) AS `P28`,(`dailysales_ct_FCST`.`P29` * -(1)) AS `P29`,(`dailysales_ct_FCST`.`P30` * -(1)) AS `P30`,(`dailysales_ct_FCST`.`P31` * -(1)) AS `P31`,(`dailysales_ct_FCST`.`P32` * -(1)) AS `P32`,(`dailysales_ct_FCST`.`P33` * -(1)) AS `P33`,(`dailysales_ct_FCST`.`P34` * -(1)) AS `P34`,(`dailysales_ct_FCST`.`P35` * -(1)) AS `P35`,(`dailysales_ct_FCST`.`P36` * -(1)) AS `P36`,(`dailysales_ct_FCST`.`P37` * -(1)) AS `P37`,(`dailysales_ct_FCST`.`P38` * -(1)) AS `P38`,(`dailysales_ct_FCST`.`P39` * -(1)) AS `P39`,(`dailysales_ct_FCST`.`P40` * -(1)) AS `P40`,(`dailysales_ct_FCST`.`P41` * -(1)) AS `P41`,(`dailysales_ct_FCST`.`P42` * -(1)) AS `P42`,(`dailysales_ct_FCST`.`P43` * -(1)) AS `P43`,(`dailysales_ct_FCST`.`P44` * -(1)) AS `P44`,(`dailysales_ct_FCST`.`P45` * -(1)) AS `P45`,(`dailysales_ct_FCST`.`P46` * -(1)) AS `P46`,(`dailysales_ct_FCST`.`P47` * -(1)) AS `P47`,(`dailysales_ct_FCST`.`P48` * -(1)) AS `P48`,(`dailysales_ct_FCST`.`P49` * -(1)) AS `P49`,(`dailysales_ct_FCST`.`P50` * -(1)) AS `P50`,(`dailysales_ct_FCST`.`P51` * -(1)) AS `P51`,(`dailysales_ct_FCST`.`P52` * -(1)) AS `P52`,(`dailysales_ct_FCST`.`P53` * -(1)) AS `P53`,(`dailysales_ct_FCST`.`P54` * -(1)) AS `P54`,(`dailysales_ct_FCST`.`P55` * -(1)) AS `P55`,(`dailysales_ct_FCST`.`P56` * -(1)) AS `P56`,(`dailysales_ct_FCST`.`P57` * -(1)) AS `P57`,(`dailysales_ct_FCST`.`P58` * -(1)) AS `P58`,(`dailysales_ct_FCST`.`P59` * -(1)) AS `P59`,(`dailysales_ct_FCST`.`P60` * -(1)) AS `P60` from `dailysales_ct_FCST`;
CREATE VIEW `drivers_calc_1a` AS select `drivers_rates`.`AccountDriver1` AS `driver`,`drivers_calc`.`FCSTDesc` AS `FCSTDesc`,`drivers_calc`.`Store` AS `Store`,`drivers_rates`.`Account` AS `Account`,`drivers_rates`.`Account_map` AS `Account_map`,0 AS `P1`,0 AS `P2`,0 AS `P3`,0 AS `P4`,0 AS `P5`,0 AS `P6`,0 AS `P7`,0 AS `P8`,0 AS `P9`,0 AS `P10`,0 AS `P11`,0 AS `P12`,0 AS `P13`,0 AS `P14`,0 AS `P15`,0 AS `P16`,0 AS `P17`,0 AS `P18`,0 AS `P19`,0 AS `P20`,0 AS `P21`,0 AS `P22`,0 AS `P23`,0 AS `P24`,(`drivers_calc`.`P25` * `drivers_rates`.`P25`) AS `P25`,(`drivers_calc`.`P26` * `drivers_rates`.`P26`) AS `P26`,(`drivers_calc`.`P27` * `drivers_rates`.`P27`) AS `P27`,(`drivers_calc`.`P28` * `drivers_rates`.`P28`) AS `P28`,(`drivers_calc`.`P29` * `drivers_rates`.`P29`) AS `P29`,(`drivers_calc`.`P30` * `drivers_rates`.`P30`) AS `P30`,(`drivers_calc`.`P31` * `drivers_rates`.`P31`) AS `P31`,(`drivers_calc`.`P32` * `drivers_rates`.`P32`) AS `P32`,(`drivers_calc`.`P33` * `drivers_rates`.`P33`) AS `P33`,(`drivers_calc`.`P34` * `drivers_rates`.`P34`) AS `P34`,(`drivers_calc`.`P35` * `drivers_rates`.`P35`) AS `P35`,(`drivers_calc`.`P36` * `drivers_rates`.`P36`) AS `P36`,(`drivers_calc`.`P37` * `drivers_rates`.`P37`) AS `P37`,(`drivers_calc`.`P38` * `drivers_rates`.`P38`) AS `P38`,(`drivers_calc`.`P39` * `drivers_rates`.`P39`) AS `P39`,(`drivers_calc`.`P40` * `drivers_rates`.`P40`) AS `P40`,(`drivers_calc`.`P41` * `drivers_rates`.`P41`) AS `P41`,(`drivers_calc`.`P42` * `drivers_rates`.`P42`) AS `P42`,(`drivers_calc`.`P43` * `drivers_rates`.`P43`) AS `P43`,(`drivers_calc`.`P44` * `drivers_rates`.`P44`) AS `P44`,(`drivers_calc`.`P45` * `drivers_rates`.`P45`) AS `P45`,(`drivers_calc`.`P46` * `drivers_rates`.`P46`) AS `P46`,(`drivers_calc`.`P47` * `drivers_rates`.`P47`) AS `P47`,(`drivers_calc`.`P48` * `drivers_rates`.`P48`) AS `P48`,(`drivers_calc`.`P49` * `drivers_rates`.`P49`) AS `P49`,(`drivers_calc`.`P50` * `drivers_rates`.`P50`) AS `P50`,(`drivers_calc`.`P51` * `drivers_rates`.`P51`) AS `P51`,(`drivers_calc`.`P52` * `drivers_rates`.`P52`) AS `P52`,(`drivers_calc`.`P53` * `drivers_rates`.`P53`) AS `P53`,(`drivers_calc`.`P54` * `drivers_rates`.`P54`) AS `P54`,(`drivers_calc`.`P55` * `drivers_rates`.`P55`) AS `P55`,(`drivers_calc`.`P56` * `drivers_rates`.`P56`) AS `P56`,(`drivers_calc`.`P57` * `drivers_rates`.`P57`) AS `P57`,(`drivers_calc`.`P58` * `drivers_rates`.`P58`) AS `P58`,(`drivers_calc`.`P59` * `drivers_rates`.`P59`) AS `P59`,(`drivers_calc`.`P60` * `drivers_rates`.`P60`) AS `P60` from (`drivers_calc` join `drivers_rates` on(((`drivers_calc`.`Account` = `drivers_rates`.`AccountDriver1`) and (`drivers_calc`.`FCSTDesc` = `drivers_rates`.`FCSTDesc`) and (`drivers_calc`.`Store` = `drivers_rates`.`Store`)))) group by `drivers_rates`.`AccountDriver1`,`drivers_calc`.`FCSTDesc`,`drivers_calc`.`Store`,`drivers_rates`.`Account`,`drivers_rates`.`Account_map` union all select `drivers_rates`.`AccountDriver2` AS `driver`,`drivers_calc`.`FCSTDesc` AS `FCSTDesc`,`drivers_calc`.`Store` AS `Store`,`drivers_rates`.`Account` AS `Account`,`drivers_rates`.`Account_map` AS `Account_map`,0 AS `P1`,0 AS `P2`,0 AS `P3`,0 AS `P4`,0 AS `P5`,0 AS `P6`,0 AS `P7`,0 AS `P8`,0 AS `P9`,0 AS `P10`,0 AS `P11`,0 AS `P12`,0 AS `P13`,0 AS `P14`,0 AS `P15`,0 AS `P16`,0 AS `P17`,0 AS `P18`,0 AS `P19`,0 AS `P20`,0 AS `P21`,0 AS `P22`,0 AS `P23`,0 AS `P24`,(`drivers_calc`.`P25` * `drivers_rates`.`P25`) AS `P25`,(`drivers_calc`.`P26` * `drivers_rates`.`P26`) AS `P26`,(`drivers_calc`.`P27` * `drivers_rates`.`P27`) AS `P27`,(`drivers_calc`.`P28` * `drivers_rates`.`P28`) AS `P28`,(`drivers_calc`.`P29` * `drivers_rates`.`P29`) AS `P29`,(`drivers_calc`.`P30` * `drivers_rates`.`P30`) AS `P30`,(`drivers_calc`.`P31` * `drivers_rates`.`P31`) AS `P31`,(`drivers_calc`.`P32` * `drivers_rates`.`P32`) AS `P32`,(`drivers_calc`.`P33` * `drivers_rates`.`P33`) AS `P33`,(`drivers_calc`.`P34` * `drivers_rates`.`P34`) AS `P34`,(`drivers_calc`.`P35` * `drivers_rates`.`P35`) AS `P35`,(`drivers_calc`.`P36` * `drivers_rates`.`P36`) AS `P36`,(`drivers_calc`.`P37` * `drivers_rates`.`P37`) AS `P37`,(`drivers_calc`.`P38` * `drivers_rates`.`P38`) AS `P38`,(`drivers_calc`.`P39` * `drivers_rates`.`P39`) AS `P39`,(`drivers_calc`.`P40` * `drivers_rates`.`P40`) AS `P40`,(`drivers_calc`.`P41` * `drivers_rates`.`P41`) AS `P41`,(`drivers_calc`.`P42` * `drivers_rates`.`P42`) AS `P42`,(`drivers_calc`.`P43` * `drivers_rates`.`P43`) AS `P43`,(`drivers_calc`.`P44` * `drivers_rates`.`P44`) AS `P44`,(`drivers_calc`.`P45` * `drivers_rates`.`P45`) AS `P45`,(`drivers_calc`.`P46` * `drivers_rates`.`P46`) AS `P46`,(`drivers_calc`.`P47` * `drivers_rates`.`P47`) AS `P47`,(`drivers_calc`.`P48` * `drivers_rates`.`P48`) AS `P48`,(`drivers_calc`.`P49` * `drivers_rates`.`P49`) AS `P49`,(`drivers_calc`.`P50` * `drivers_rates`.`P50`) AS `P50`,(`drivers_calc`.`P51` * `drivers_rates`.`P51`) AS `P51`,(`drivers_calc`.`P52` * `drivers_rates`.`P52`) AS `P52`,(`drivers_calc`.`P53` * `drivers_rates`.`P53`) AS `P53`,(`drivers_calc`.`P54` * `drivers_rates`.`P54`) AS `P54`,(`drivers_calc`.`P55` * `drivers_rates`.`P55`) AS `P55`,(`drivers_calc`.`P56` * `drivers_rates`.`P56`) AS `P56`,(`drivers_calc`.`P57` * `drivers_rates`.`P57`) AS `P57`,(`drivers_calc`.`P58` * `drivers_rates`.`P58`) AS `P58`,(`drivers_calc`.`P59` * `drivers_rates`.`P59`) AS `P59`,(`drivers_calc`.`P60` * `drivers_rates`.`P60`) AS `P60` from (`drivers_calc` join `drivers_rates` on(((`drivers_calc`.`Account` = `drivers_rates`.`AccountDriver2`) and (`drivers_calc`.`FCSTDesc` = `drivers_rates`.`FCSTDesc`) and (`drivers_calc`.`Store` = `drivers_rates`.`Store`)))) group by `drivers_rates`.`AccountDriver2`,`drivers_calc`.`FCSTDesc`,`drivers_calc`.`Store`,`drivers_rates`.`Account`,`drivers_rates`.`Account_map` union all select `drivers_rates`.`AccountDriver3` AS `driver`,`drivers_calc`.`FCSTDesc` AS `FCSTDesc`,`drivers_calc`.`Store` AS `Store`,`drivers_rates`.`Account` AS `Account`,`drivers_rates`.`Account_map` AS `Account_map`,0 AS `P1`,0 AS `P2`,0 AS `P3`,0 AS `P4`,0 AS `P5`,0 AS `P6`,0 AS `P7`,0 AS `P8`,0 AS `P9`,0 AS `P10`,0 AS `P11`,0 AS `P12`,0 AS `P13`,0 AS `P14`,0 AS `P15`,0 AS `P16`,0 AS `P17`,0 AS `P18`,0 AS `P19`,0 AS `P20`,0 AS `P21`,0 AS `P22`,0 AS `P23`,0 AS `P24`,(`drivers_calc`.`P25` * `drivers_rates`.`P25`) AS `P25`,(`drivers_calc`.`P26` * `drivers_rates`.`P26`) AS `P26`,(`drivers_calc`.`P27` * `drivers_rates`.`P27`) AS `P27`,(`drivers_calc`.`P28` * `drivers_rates`.`P28`) AS `P28`,(`drivers_calc`.`P29` * `drivers_rates`.`P29`) AS `P29`,(`drivers_calc`.`P30` * `drivers_rates`.`P30`) AS `P30`,(`drivers_calc`.`P31` * `drivers_rates`.`P31`) AS `P31`,(`drivers_calc`.`P32` * `drivers_rates`.`P32`) AS `P32`,(`drivers_calc`.`P33` * `drivers_rates`.`P33`) AS `P33`,(`drivers_calc`.`P34` * `drivers_rates`.`P34`) AS `P34`,(`drivers_calc`.`P35` * `drivers_rates`.`P35`) AS `P35`,(`drivers_calc`.`P36` * `drivers_rates`.`P36`) AS `P36`,(`drivers_calc`.`P37` * `drivers_rates`.`P37`) AS `P37`,(`drivers_calc`.`P38` * `drivers_rates`.`P38`) AS `P38`,(`drivers_calc`.`P39` * `drivers_rates`.`P39`) AS `P39`,(`drivers_calc`.`P40` * `drivers_rates`.`P40`) AS `P40`,(`drivers_calc`.`P41` * `drivers_rates`.`P41`) AS `P41`,(`drivers_calc`.`P42` * `drivers_rates`.`P42`) AS `P42`,(`drivers_calc`.`P43` * `drivers_rates`.`P43`) AS `P43`,(`drivers_calc`.`P44` * `drivers_rates`.`P44`) AS `P44`,(`drivers_calc`.`P45` * `drivers_rates`.`P45`) AS `P45`,(`drivers_calc`.`P46` * `drivers_rates`.`P46`) AS `P46`,(`drivers_calc`.`P47` * `drivers_rates`.`P47`) AS `P47`,(`drivers_calc`.`P48` * `drivers_rates`.`P48`) AS `P48`,(`drivers_calc`.`P49` * `drivers_rates`.`P49`) AS `P49`,(`drivers_calc`.`P50` * `drivers_rates`.`P50`) AS `P50`,(`drivers_calc`.`P51` * `drivers_rates`.`P51`) AS `P51`,(`drivers_calc`.`P52` * `drivers_rates`.`P52`) AS `P52`,(`drivers_calc`.`P53` * `drivers_rates`.`P53`) AS `P53`,(`drivers_calc`.`P54` * `drivers_rates`.`P54`) AS `P54`,(`drivers_calc`.`P55` * `drivers_rates`.`P55`) AS `P55`,(`drivers_calc`.`P56` * `drivers_rates`.`P56`) AS `P56`,(`drivers_calc`.`P57` * `drivers_rates`.`P57`) AS `P57`,(`drivers_calc`.`P58` * `drivers_rates`.`P58`) AS `P58`,(`drivers_calc`.`P59` * `drivers_rates`.`P59`) AS `P59`,(`drivers_calc`.`P60` * `drivers_rates`.`P60`) AS `P60` from (`drivers_calc` join `drivers_rates` on(((`drivers_calc`.`Account` = `drivers_rates`.`AccountDriver3`) and (`drivers_calc`.`FCSTDesc` = `drivers_rates`.`FCSTDesc`) and (`drivers_calc`.`Store` = `drivers_rates`.`Store`)))) group by `drivers_rates`.`AccountDriver3`,`drivers_calc`.`FCSTDesc`,`drivers_calc`.`Store`,`drivers_rates`.`Account`,`drivers_rates`.`Account_map`;
CREATE VIEW `drivers_calc_1b` AS select `drivers_rates`.`AccountDriver2` AS `driver`,`drivers_calc_1a`.`FCSTDesc` AS `FCSTDesc`,`drivers_calc_1a`.`Store` AS `Store`,`drivers_rates`.`Account` AS `Account`,`drivers_rates`.`Account_map` AS `Account_map`,0 AS `P1`,0 AS `P2`,0 AS `P3`,0 AS `P4`,0 AS `P5`,0 AS `P6`,0 AS `P7`,0 AS `P8`,0 AS `P9`,0 AS `P10`,0 AS `P11`,0 AS `P12`,0 AS `P13`,0 AS `P14`,0 AS `P15`,0 AS `P16`,0 AS `P17`,0 AS `P18`,0 AS `P19`,0 AS `P20`,0 AS `P21`,0 AS `P22`,0 AS `P23`,0 AS `P24`,(`drivers_calc_1a`.`P25` * `drivers_rates`.`P25`) AS `P25`,(`drivers_calc_1a`.`P26` * `drivers_rates`.`P26`) AS `P26`,(`drivers_calc_1a`.`P27` * `drivers_rates`.`P27`) AS `P27`,(`drivers_calc_1a`.`P28` * `drivers_rates`.`P28`) AS `P28`,(`drivers_calc_1a`.`P29` * `drivers_rates`.`P29`) AS `P29`,(`drivers_calc_1a`.`P30` * `drivers_rates`.`P30`) AS `P30`,(`drivers_calc_1a`.`P31` * `drivers_rates`.`P31`) AS `P31`,(`drivers_calc_1a`.`P32` * `drivers_rates`.`P32`) AS `P32`,(`drivers_calc_1a`.`P33` * `drivers_rates`.`P33`) AS `P33`,(`drivers_calc_1a`.`P34` * `drivers_rates`.`P34`) AS `P34`,(`drivers_calc_1a`.`P35` * `drivers_rates`.`P35`) AS `P35`,(`drivers_calc_1a`.`P36` * `drivers_rates`.`P36`) AS `P36`,(`drivers_calc_1a`.`P37` * `drivers_rates`.`P37`) AS `P37`,(`drivers_calc_1a`.`P38` * `drivers_rates`.`P38`) AS `P38`,(`drivers_calc_1a`.`P39` * `drivers_rates`.`P39`) AS `P39`,(`drivers_calc_1a`.`P40` * `drivers_rates`.`P40`) AS `P40`,(`drivers_calc_1a`.`P41` * `drivers_rates`.`P41`) AS `P41`,(`drivers_calc_1a`.`P42` * `drivers_rates`.`P42`) AS `P42`,(`drivers_calc_1a`.`P43` * `drivers_rates`.`P43`) AS `P43`,(`drivers_calc_1a`.`P44` * `drivers_rates`.`P44`) AS `P44`,(`drivers_calc_1a`.`P45` * `drivers_rates`.`P45`) AS `P45`,(`drivers_calc_1a`.`P46` * `drivers_rates`.`P46`) AS `P46`,(`drivers_calc_1a`.`P47` * `drivers_rates`.`P47`) AS `P47`,(`drivers_calc_1a`.`P48` * `drivers_rates`.`P48`) AS `P48`,(`drivers_calc_1a`.`P49` * `drivers_rates`.`P49`) AS `P49`,(`drivers_calc_1a`.`P50` * `drivers_rates`.`P50`) AS `P50`,(`drivers_calc_1a`.`P51` * `drivers_rates`.`P51`) AS `P51`,(`drivers_calc_1a`.`P52` * `drivers_rates`.`P52`) AS `P52`,(`drivers_calc_1a`.`P53` * `drivers_rates`.`P53`) AS `P53`,(`drivers_calc_1a`.`P54` * `drivers_rates`.`P54`) AS `P54`,(`drivers_calc_1a`.`P55` * `drivers_rates`.`P55`) AS `P55`,(`drivers_calc_1a`.`P56` * `drivers_rates`.`P56`) AS `P56`,(`drivers_calc_1a`.`P57` * `drivers_rates`.`P57`) AS `P57`,(`drivers_calc_1a`.`P58` * `drivers_rates`.`P58`) AS `P58`,(`drivers_calc_1a`.`P59` * `drivers_rates`.`P59`) AS `P59`,(`drivers_calc_1a`.`P60` * `drivers_rates`.`P60`) AS `P60` from (`drivers_calc_1a` join `drivers_rates` on(((`drivers_calc_1a`.`Account` = `drivers_rates`.`AccountDriver2`) and (`drivers_calc_1a`.`FCSTDesc` = `drivers_rates`.`FCSTDesc`) and (`drivers_calc_1a`.`Store` = `drivers_rates`.`Store`)))) group by `drivers_rates`.`AccountDriver2`,`drivers_calc_1a`.`FCSTDesc`,`drivers_calc_1a`.`Store`,`drivers_rates`.`Account`,`drivers_rates`.`Account_map` union all select `drivers_calc_1a`.`driver` AS `driver`,`drivers_calc_1a`.`FCSTDesc` AS `FCSTDesc`,`drivers_calc_1a`.`Store` AS `Store`,`drivers_calc_1a`.`Account` AS `Account`,`drivers_calc_1a`.`Account_map` AS `Account_map`,0 AS `P1`,0 AS `P2`,0 AS `P3`,0 AS `P4`,0 AS `P5`,0 AS `P6`,0 AS `P7`,0 AS `P8`,0 AS `P9`,0 AS `P10`,0 AS `P11`,0 AS `P12`,0 AS `P13`,0 AS `P14`,0 AS `P15`,0 AS `P16`,0 AS `P17`,0 AS `P18`,0 AS `P19`,0 AS `P20`,0 AS `P21`,0 AS `P22`,0 AS `P23`,0 AS `P24`,`drivers_calc_1a`.`P25` AS `P25`,`drivers_calc_1a`.`P26` AS `P26`,`drivers_calc_1a`.`P27` AS `P27`,`drivers_calc_1a`.`P28` AS `P28`,`drivers_calc_1a`.`P29` AS `P29`,`drivers_calc_1a`.`P30` AS `P30`,`drivers_calc_1a`.`P31` AS `P31`,`drivers_calc_1a`.`P32` AS `P32`,`drivers_calc_1a`.`P33` AS `P33`,`drivers_calc_1a`.`P34` AS `P34`,`drivers_calc_1a`.`P35` AS `P35`,`drivers_calc_1a`.`P36` AS `P36`,`drivers_calc_1a`.`P37` AS `P37`,`drivers_calc_1a`.`P38` AS `P38`,`drivers_calc_1a`.`P39` AS `P39`,`drivers_calc_1a`.`P40` AS `P40`,`drivers_calc_1a`.`P41` AS `P41`,`drivers_calc_1a`.`P42` AS `P42`,`drivers_calc_1a`.`P43` AS `P43`,`drivers_calc_1a`.`P44` AS `P44`,`drivers_calc_1a`.`P45` AS `P45`,`drivers_calc_1a`.`P46` AS `P46`,`drivers_calc_1a`.`P47` AS `P47`,`drivers_calc_1a`.`P48` AS `P48`,`drivers_calc_1a`.`P49` AS `P49`,`drivers_calc_1a`.`P50` AS `P50`,`drivers_calc_1a`.`P51` AS `P51`,`drivers_calc_1a`.`P52` AS `P52`,`drivers_calc_1a`.`P53` AS `P53`,`drivers_calc_1a`.`P54` AS `P54`,`drivers_calc_1a`.`P55` AS `P55`,`drivers_calc_1a`.`P56` AS `P56`,`drivers_calc_1a`.`P57` AS `P57`,`drivers_calc_1a`.`P58` AS `P58`,`drivers_calc_1a`.`P59` AS `P59`,`drivers_calc_1a`.`P60` AS `P60` from `drivers_calc_1a` where (`drivers_calc_1a`.`driver` <> _utf8'Total Sales');
CREATE VIEW `drivers_calc2` AS select `drivers_calc_1b`.`driver` AS `driver`,`drivers_calc_1b`.`FCSTDesc` AS `FCSTDesc`,`drivers_calc_1b`.`Store` AS `Store`,`drivers_calc_1b`.`Account` AS `Account`,`drivers_calc_1b`.`Account_map` AS `Account_map`,(`drivers_calc_1b`.`P1` * `acct_tree2`.`sign`) AS `P1`,(`drivers_calc_1b`.`P2` * `acct_tree2`.`sign`) AS `P2`,(`drivers_calc_1b`.`P3` * `acct_tree2`.`sign`) AS `P3`,(`drivers_calc_1b`.`P4` * `acct_tree2`.`sign`) AS `P4`,(`drivers_calc_1b`.`P5` * `acct_tree2`.`sign`) AS `P5`,(`drivers_calc_1b`.`P6` * `acct_tree2`.`sign`) AS `P6`,(`drivers_calc_1b`.`P7` * `acct_tree2`.`sign`) AS `P7`,(`drivers_calc_1b`.`P8` * `acct_tree2`.`sign`) AS `P8`,(`drivers_calc_1b`.`P9` * `acct_tree2`.`sign`) AS `P9`,(`drivers_calc_1b`.`P10` * `acct_tree2`.`sign`) AS `P10`,(`drivers_calc_1b`.`P11` * `acct_tree2`.`sign`) AS `P11`,(`drivers_calc_1b`.`P12` * `acct_tree2`.`sign`) AS `P12`,(`drivers_calc_1b`.`P13` * `acct_tree2`.`sign`) AS `P13`,(`drivers_calc_1b`.`P14` * `acct_tree2`.`sign`) AS `P14`,(`drivers_calc_1b`.`P15` * `acct_tree2`.`sign`) AS `P15`,(`drivers_calc_1b`.`P16` * `acct_tree2`.`sign`) AS `P16`,(`drivers_calc_1b`.`P17` * `acct_tree2`.`sign`) AS `P17`,(`drivers_calc_1b`.`P18` * `acct_tree2`.`sign`) AS `P18`,(`drivers_calc_1b`.`P19` * `acct_tree2`.`sign`) AS `P19`,(`drivers_calc_1b`.`P20` * `acct_tree2`.`sign`) AS `P20`,(`drivers_calc_1b`.`P21` * `acct_tree2`.`sign`) AS `P21`,(`drivers_calc_1b`.`P22` * `acct_tree2`.`sign`) AS `P22`,(`drivers_calc_1b`.`P23` * `acct_tree2`.`sign`) AS `P23`,(`drivers_calc_1b`.`P24` * `acct_tree2`.`sign`) AS `P24`,(`drivers_calc_1b`.`P25` * `acct_tree2`.`sign`) AS `P25`,(`drivers_calc_1b`.`P26` * `acct_tree2`.`sign`) AS `P26`,(`drivers_calc_1b`.`P27` * `acct_tree2`.`sign`) AS `P27`,(`drivers_calc_1b`.`P28` * `acct_tree2`.`sign`) AS `P28`,(`drivers_calc_1b`.`P29` * `acct_tree2`.`sign`) AS `P29`,(`drivers_calc_1b`.`P30` * `acct_tree2`.`sign`) AS `P30`,(`drivers_calc_1b`.`P31` * `acct_tree2`.`sign`) AS `P31`,(`drivers_calc_1b`.`P32` * `acct_tree2`.`sign`) AS `P32`,(`drivers_calc_1b`.`P33` * `acct_tree2`.`sign`) AS `P33`,(`drivers_calc_1b`.`P34` * `acct_tree2`.`sign`) AS `P34`,(`drivers_calc_1b`.`P35` * `acct_tree2`.`sign`) AS `P35`,(`drivers_calc_1b`.`P36` * `acct_tree2`.`sign`) AS `P36`,(`drivers_calc_1b`.`P37` * `acct_tree2`.`sign`) AS `P37`,(`drivers_calc_1b`.`P38` * `acct_tree2`.`sign`) AS `P38`,(`drivers_calc_1b`.`P39` * `acct_tree2`.`sign`) AS `P39`,(`drivers_calc_1b`.`P40` * `acct_tree2`.`sign`) AS `P40`,(`drivers_calc_1b`.`P41` * `acct_tree2`.`sign`) AS `P41`,(`drivers_calc_1b`.`P42` * `acct_tree2`.`sign`) AS `P42`,(`drivers_calc_1b`.`P43` * `acct_tree2`.`sign`) AS `P43`,(`drivers_calc_1b`.`P44` * `acct_tree2`.`sign`) AS `P44`,(`drivers_calc_1b`.`P45` * `acct_tree2`.`sign`) AS `P45`,(`drivers_calc_1b`.`P46` * `acct_tree2`.`sign`) AS `P46`,(`drivers_calc_1b`.`P47` * `acct_tree2`.`sign`) AS `P47`,(`drivers_calc_1b`.`P48` * `acct_tree2`.`sign`) AS `P48`,(`drivers_calc_1b`.`P49` * `acct_tree2`.`sign`) AS `P49`,(`drivers_calc_1b`.`P50` * `acct_tree2`.`sign`) AS `P50`,(`drivers_calc_1b`.`P51` * `acct_tree2`.`sign`) AS `P51`,(`drivers_calc_1b`.`P52` * `acct_tree2`.`sign`) AS `P52`,(`drivers_calc_1b`.`P53` * `acct_tree2`.`sign`) AS `P53`,(`drivers_calc_1b`.`P54` * `acct_tree2`.`sign`) AS `P54`,(`drivers_calc_1b`.`P55` * `acct_tree2`.`sign`) AS `P55`,(`drivers_calc_1b`.`P56` * `acct_tree2`.`sign`) AS `P56`,(`drivers_calc_1b`.`P57` * `acct_tree2`.`sign`) AS `P57`,(`drivers_calc_1b`.`P58` * `acct_tree2`.`sign`) AS `P58`,(`drivers_calc_1b`.`P59` * `acct_tree2`.`sign`) AS `P59`,(`drivers_calc_1b`.`P60` * `acct_tree2`.`sign`) AS `P60` from ((`drivers_calc_1b` join `driver_acct` on((convert(`drivers_calc_1b`.`Account` using utf8) = `driver_acct`.`acct`))) join `acct_tree2` on((convert(`drivers_calc_1b`.`Account_map` using utf8) = convert(`acct_tree2`.`acct` using utf8)))) union all select `drivers_calc`.`Driver` AS `Driver`,`drivers_calc`.`FCSTDesc` AS `FCSTDesc`,`drivers_calc`.`Store` AS `Store`,`drivers_calc`.`Account` AS `Account`,`drivers_calc`.`Account_map` AS `Account_map`,(`drivers_calc`.`P1` * `acct_tree2`.`sign`) AS `P1`,(`drivers_calc`.`P2` * `acct_tree2`.`sign`) AS `P2`,(`drivers_calc`.`P3` * `acct_tree2`.`sign`) AS `P3`,(`drivers_calc`.`P4` * `acct_tree2`.`sign`) AS `P4`,(`drivers_calc`.`P5` * `acct_tree2`.`sign`) AS `P5`,(`drivers_calc`.`P6` * `acct_tree2`.`sign`) AS `P6`,(`drivers_calc`.`P7` * `acct_tree2`.`sign`) AS `P7`,(`drivers_calc`.`P8` * `acct_tree2`.`sign`) AS `P8`,(`drivers_calc`.`P9` * `acct_tree2`.`sign`) AS `P9`,(`drivers_calc`.`P10` * `acct_tree2`.`sign`) AS `P10`,(`drivers_calc`.`P11` * `acct_tree2`.`sign`) AS `P11`,(`drivers_calc`.`P12` * `acct_tree2`.`sign`) AS `P12`,(`drivers_calc`.`P13` * `acct_tree2`.`sign`) AS `P13`,(`drivers_calc`.`P14` * `acct_tree2`.`sign`) AS `P14`,(`drivers_calc`.`P15` * `acct_tree2`.`sign`) AS `P15`,(`drivers_calc`.`P16` * `acct_tree2`.`sign`) AS `P16`,(`drivers_calc`.`P17` * `acct_tree2`.`sign`) AS `P17`,(`drivers_calc`.`P18` * `acct_tree2`.`sign`) AS `P18`,(`drivers_calc`.`P19` * `acct_tree2`.`sign`) AS `P19`,(`drivers_calc`.`P20` * `acct_tree2`.`sign`) AS `P20`,(`drivers_calc`.`P21` * `acct_tree2`.`sign`) AS `P21`,(`drivers_calc`.`P22` * `acct_tree2`.`sign`) AS `P22`,(`drivers_calc`.`P23` * `acct_tree2`.`sign`) AS `P23`,(`drivers_calc`.`P24` * `acct_tree2`.`sign`) AS `P24`,(`drivers_calc`.`P25` * `acct_tree2`.`sign`) AS `P25`,(`drivers_calc`.`P26` * `acct_tree2`.`sign`) AS `P26`,(`drivers_calc`.`P27` * `acct_tree2`.`sign`) AS `P27`,(`drivers_calc`.`P28` * `acct_tree2`.`sign`) AS `P28`,(`drivers_calc`.`P29` * `acct_tree2`.`sign`) AS `P29`,(`drivers_calc`.`P30` * `acct_tree2`.`sign`) AS `P30`,(`drivers_calc`.`P31` * `acct_tree2`.`sign`) AS `P31`,(`drivers_calc`.`P32` * `acct_tree2`.`sign`) AS `P32`,(`drivers_calc`.`P33` * `acct_tree2`.`sign`) AS `P33`,(`drivers_calc`.`P34` * `acct_tree2`.`sign`) AS `P34`,(`drivers_calc`.`P35` * `acct_tree2`.`sign`) AS `P35`,(`drivers_calc`.`P36` * `acct_tree2`.`sign`) AS `P36`,(`drivers_calc`.`P37` * `acct_tree2`.`sign`) AS `P37`,(`drivers_calc`.`P38` * `acct_tree2`.`sign`) AS `P38`,(`drivers_calc`.`P39` * `acct_tree2`.`sign`) AS `P39`,(`drivers_calc`.`P40` * `acct_tree2`.`sign`) AS `P40`,(`drivers_calc`.`P41` * `acct_tree2`.`sign`) AS `P41`,(`drivers_calc`.`P42` * `acct_tree2`.`sign`) AS `P42`,(`drivers_calc`.`P43` * `acct_tree2`.`sign`) AS `P43`,(`drivers_calc`.`P44` * `acct_tree2`.`sign`) AS `P44`,(`drivers_calc`.`P45` * `acct_tree2`.`sign`) AS `P45`,(`drivers_calc`.`P46` * `acct_tree2`.`sign`) AS `P46`,(`drivers_calc`.`P47` * `acct_tree2`.`sign`) AS `P47`,(`drivers_calc`.`P48` * `acct_tree2`.`sign`) AS `P48`,(`drivers_calc`.`P49` * `acct_tree2`.`sign`) AS `P49`,(`drivers_calc`.`P50` * `acct_tree2`.`sign`) AS `P50`,(`drivers_calc`.`P51` * `acct_tree2`.`sign`) AS `P51`,(`drivers_calc`.`P52` * `acct_tree2`.`sign`) AS `P52`,(`drivers_calc`.`P53` * `acct_tree2`.`sign`) AS `P53`,(`drivers_calc`.`P54` * `acct_tree2`.`sign`) AS `P54`,(`drivers_calc`.`P55` * `acct_tree2`.`sign`) AS `P55`,(`drivers_calc`.`P56` * `acct_tree2`.`sign`) AS `P56`,(`drivers_calc`.`P57` * `acct_tree2`.`sign`) AS `P57`,(`drivers_calc`.`P58` * `acct_tree2`.`sign`) AS `P58`,(`drivers_calc`.`P59` * `acct_tree2`.`sign`) AS `P59`,(`drivers_calc`.`P60` * `acct_tree2`.`sign`) AS `P60` from (`drivers_calc` join `acct_tree2` on((`drivers_calc`.`Account_map` = convert(`acct_tree2`.`acct` using utf8))));
CREATE VIEW `master_fcst_cons` AS select `versions`.`FCSTDesc` AS `FCSTDesc`,`versions`.`effective_period_number` AS `effective_period_number`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,(`master_fcst_actual`.`P1` * (1 - `EffectivePeriodCalc`.`P1`)) AS `P1`,(`master_fcst_actual`.`P2` * (1 - `EffectivePeriodCalc`.`P2`)) AS `P2`,(`master_fcst_actual`.`P3` * (1 - `EffectivePeriodCalc`.`P3`)) AS `P3`,(`master_fcst_actual`.`P4` * (1 - `EffectivePeriodCalc`.`P4`)) AS `P4`,(`master_fcst_actual`.`P5` * (1 - `EffectivePeriodCalc`.`P5`)) AS `P5`,(`master_fcst_actual`.`P6` * (1 - `EffectivePeriodCalc`.`P6`)) AS `P6`,(`master_fcst_actual`.`P7` * (1 - `EffectivePeriodCalc`.`P7`)) AS `P7`,(`master_fcst_actual`.`P8` * (1 - `EffectivePeriodCalc`.`P8`)) AS `P8`,(`master_fcst_actual`.`P9` * (1 - `EffectivePeriodCalc`.`P9`)) AS `P9`,(`master_fcst_actual`.`P10` * (1 - `EffectivePeriodCalc`.`P10`)) AS `P10`,(`master_fcst_actual`.`P11` * (1 - `EffectivePeriodCalc`.`P11`)) AS `P11`,(`master_fcst_actual`.`P12` * (1 - `EffectivePeriodCalc`.`P12`)) AS `P12`,(`master_fcst_actual`.`P13` * (1 - `EffectivePeriodCalc`.`P13`)) AS `P13`,(`master_fcst_actual`.`P14` * (1 - `EffectivePeriodCalc`.`P14`)) AS `P14`,(`master_fcst_actual`.`P15` * (1 - `EffectivePeriodCalc`.`P15`)) AS `P15`,(`master_fcst_actual`.`P16` * (1 - `EffectivePeriodCalc`.`P16`)) AS `P16`,(`master_fcst_actual`.`P17` * (1 - `EffectivePeriodCalc`.`P17`)) AS `P17`,(`master_fcst_actual`.`P18` * (1 - `EffectivePeriodCalc`.`P18`)) AS `P18`,(`master_fcst_actual`.`P19` * (1 - `EffectivePeriodCalc`.`P19`)) AS `P19`,(`master_fcst_actual`.`P20` * (1 - `EffectivePeriodCalc`.`P20`)) AS `P20`,(`master_fcst_actual`.`P21` * (1 - `EffectivePeriodCalc`.`P21`)) AS `P21`,(`master_fcst_actual`.`P22` * (1 - `EffectivePeriodCalc`.`P22`)) AS `P22`,(`master_fcst_actual`.`P23` * (1 - `EffectivePeriodCalc`.`P23`)) AS `P23`,(`master_fcst_actual`.`P24` * (1 - `EffectivePeriodCalc`.`P24`)) AS `P24`,(`master_fcst_actual`.`P25` * (1 - `EffectivePeriodCalc`.`P25`)) AS `P25`,(`master_fcst_actual`.`P26` * (1 - `EffectivePeriodCalc`.`P26`)) AS `P26`,(`master_fcst_actual`.`P27` * (1 - `EffectivePeriodCalc`.`P27`)) AS `P27`,(`master_fcst_actual`.`P28` * (1 - `EffectivePeriodCalc`.`P28`)) AS `P28`,(`master_fcst_actual`.`P29` * (1 - `EffectivePeriodCalc`.`P29`)) AS `P29`,(`master_fcst_actual`.`P30` * (1 - `EffectivePeriodCalc`.`P30`)) AS `P30`,(`master_fcst_actual`.`P31` * (1 - `EffectivePeriodCalc`.`P31`)) AS `P31`,(`master_fcst_actual`.`P32` * (1 - `EffectivePeriodCalc`.`P32`)) AS `P32`,(`master_fcst_actual`.`P33` * (1 - `EffectivePeriodCalc`.`P33`)) AS `P33`,(`master_fcst_actual`.`P34` * (1 - `EffectivePeriodCalc`.`P34`)) AS `P34`,(`master_fcst_actual`.`P35` * (1 - `EffectivePeriodCalc`.`P35`)) AS `P35`,(`master_fcst_actual`.`P36` * (1 - `EffectivePeriodCalc`.`P36`)) AS `P36`,(`master_fcst_actual`.`P37` * (1 - `EffectivePeriodCalc`.`P37`)) AS `P37`,(`master_fcst_actual`.`P38` * (1 - `EffectivePeriodCalc`.`P38`)) AS `P38`,(`master_fcst_actual`.`P39` * (1 - `EffectivePeriodCalc`.`P39`)) AS `P39`,(`master_fcst_actual`.`P40` * (1 - `EffectivePeriodCalc`.`P40`)) AS `P40`,(`master_fcst_actual`.`P41` * (1 - `EffectivePeriodCalc`.`P41`)) AS `P41`,(`master_fcst_actual`.`P42` * (1 - `EffectivePeriodCalc`.`P42`)) AS `P42`,(`master_fcst_actual`.`P43` * (1 - `EffectivePeriodCalc`.`P43`)) AS `P43`,(`master_fcst_actual`.`P44` * (1 - `EffectivePeriodCalc`.`P44`)) AS `P44`,(`master_fcst_actual`.`P45` * (1 - `EffectivePeriodCalc`.`P45`)) AS `P45`,(`master_fcst_actual`.`P46` * (1 - `EffectivePeriodCalc`.`P46`)) AS `P46`,(`master_fcst_actual`.`P47` * (1 - `EffectivePeriodCalc`.`P47`)) AS `P47`,(`master_fcst_actual`.`P48` * (1 - `EffectivePeriodCalc`.`P48`)) AS `P48`,(`master_fcst_actual`.`P49` * (1 - `EffectivePeriodCalc`.`P49`)) AS `P49`,(`master_fcst_actual`.`P50` * (1 - `EffectivePeriodCalc`.`P50`)) AS `P50`,(`master_fcst_actual`.`P51` * (1 - `EffectivePeriodCalc`.`P51`)) AS `P51`,(`master_fcst_actual`.`P52` * (1 - `EffectivePeriodCalc`.`P52`)) AS `P52`,(`master_fcst_actual`.`P53` * (1 - `EffectivePeriodCalc`.`P53`)) AS `P53`,(`master_fcst_actual`.`P54` * (1 - `EffectivePeriodCalc`.`P54`)) AS `P54`,(`master_fcst_actual`.`P55` * (1 - `EffectivePeriodCalc`.`P55`)) AS `P55`,(`master_fcst_actual`.`P56` * (1 - `EffectivePeriodCalc`.`P56`)) AS `P56`,(`master_fcst_actual`.`P57` * (1 - `EffectivePeriodCalc`.`P57`)) AS `P57`,(`master_fcst_actual`.`P58` * (1 - `EffectivePeriodCalc`.`P58`)) AS `P58`,(`master_fcst_actual`.`P59` * (1 - `EffectivePeriodCalc`.`P59`)) AS `P59`,(`master_fcst_actual`.`P60` * (1 - `EffectivePeriodCalc`.`P60`)) AS `P60` from ((`master_fcst_actual` join `versions`) join `EffectivePeriodCalc` on((`versions`.`effective_period_number` = `EffectivePeriodCalc`.`Effective_Period`))) union all select `drivers_calc2`.`FCSTDesc` AS `FCSTDesc`,`versions`.`effective_period_number` AS `effective_period_number`,`drivers_calc2`.`Store` AS `Store`,`drivers_calc2`.`Account_map` AS `Account_map`,(`drivers_calc2`.`P1` * `EffectivePeriodCalc`.`P1`) AS `P1`,(`drivers_calc2`.`P2` * `EffectivePeriodCalc`.`P2`) AS `P2`,(`drivers_calc2`.`P3` * `EffectivePeriodCalc`.`P3`) AS `P3`,(`drivers_calc2`.`P4` * `EffectivePeriodCalc`.`P4`) AS `P4`,(`drivers_calc2`.`P5` * `EffectivePeriodCalc`.`P5`) AS `P5`,(`drivers_calc2`.`P6` * `EffectivePeriodCalc`.`P6`) AS `P6`,(`drivers_calc2`.`P7` * `EffectivePeriodCalc`.`P7`) AS `P7`,(`drivers_calc2`.`P8` * `EffectivePeriodCalc`.`P8`) AS `P8`,(`drivers_calc2`.`P9` * `EffectivePeriodCalc`.`P9`) AS `P9`,(`drivers_calc2`.`P10` * `EffectivePeriodCalc`.`P10`) AS `P10`,(`drivers_calc2`.`P11` * `EffectivePeriodCalc`.`P11`) AS `P11`,(`drivers_calc2`.`P12` * `EffectivePeriodCalc`.`P12`) AS `P12`,(`drivers_calc2`.`P13` * `EffectivePeriodCalc`.`P13`) AS `P13`,(`drivers_calc2`.`P14` * `EffectivePeriodCalc`.`P14`) AS `P14`,(`drivers_calc2`.`P15` * `EffectivePeriodCalc`.`P15`) AS `P15`,(`drivers_calc2`.`P16` * `EffectivePeriodCalc`.`P16`) AS `P16`,(`drivers_calc2`.`P17` * `EffectivePeriodCalc`.`P17`) AS `P17`,(`drivers_calc2`.`P18` * `EffectivePeriodCalc`.`P18`) AS `P18`,(`drivers_calc2`.`P19` * `EffectivePeriodCalc`.`P19`) AS `P19`,(`drivers_calc2`.`P20` * `EffectivePeriodCalc`.`P20`) AS `P20`,(`drivers_calc2`.`P21` * `EffectivePeriodCalc`.`P21`) AS `P21`,(`drivers_calc2`.`P22` * `EffectivePeriodCalc`.`P22`) AS `P22`,(`drivers_calc2`.`P23` * `EffectivePeriodCalc`.`P23`) AS `P23`,(`drivers_calc2`.`P24` * `EffectivePeriodCalc`.`P24`) AS `P24`,(`drivers_calc2`.`P25` * `EffectivePeriodCalc`.`P25`) AS `P25`,(`drivers_calc2`.`P26` * `EffectivePeriodCalc`.`P26`) AS `P26`,(`drivers_calc2`.`P27` * `EffectivePeriodCalc`.`P27`) AS `P27`,(`drivers_calc2`.`P28` * `EffectivePeriodCalc`.`P28`) AS `P28`,(`drivers_calc2`.`P29` * `EffectivePeriodCalc`.`P29`) AS `P29`,(`drivers_calc2`.`P30` * `EffectivePeriodCalc`.`P30`) AS `P30`,(`drivers_calc2`.`P31` * `EffectivePeriodCalc`.`P31`) AS `P31`,(`drivers_calc2`.`P32` * `EffectivePeriodCalc`.`P32`) AS `P32`,(`drivers_calc2`.`P33` * `EffectivePeriodCalc`.`P33`) AS `P33`,(`drivers_calc2`.`P34` * `EffectivePeriodCalc`.`P34`) AS `P34`,(`drivers_calc2`.`P35` * `EffectivePeriodCalc`.`P35`) AS `P35`,(`drivers_calc2`.`P36` * `EffectivePeriodCalc`.`P36`) AS `P36`,(`drivers_calc2`.`P37` * `EffectivePeriodCalc`.`P37`) AS `P37`,(`drivers_calc2`.`P38` * `EffectivePeriodCalc`.`P38`) AS `P38`,(`drivers_calc2`.`P39` * `EffectivePeriodCalc`.`P39`) AS `P39`,(`drivers_calc2`.`P40` * `EffectivePeriodCalc`.`P40`) AS `P40`,(`drivers_calc2`.`P41` * `EffectivePeriodCalc`.`P41`) AS `P41`,(`drivers_calc2`.`P42` * `EffectivePeriodCalc`.`P42`) AS `P42`,(`drivers_calc2`.`P43` * `EffectivePeriodCalc`.`P43`) AS `P43`,(`drivers_calc2`.`P44` * `EffectivePeriodCalc`.`P44`) AS `P44`,(`drivers_calc2`.`P45` * `EffectivePeriodCalc`.`P45`) AS `P45`,(`drivers_calc2`.`P46` * `EffectivePeriodCalc`.`P46`) AS `P46`,(`drivers_calc2`.`P47` * `EffectivePeriodCalc`.`P47`) AS `P47`,(`drivers_calc2`.`P48` * `EffectivePeriodCalc`.`P48`) AS `P48`,(`drivers_calc2`.`P49` * `EffectivePeriodCalc`.`P49`) AS `P49`,(`drivers_calc2`.`P50` * `EffectivePeriodCalc`.`P50`) AS `P50`,(`drivers_calc2`.`P51` * `EffectivePeriodCalc`.`P51`) AS `P51`,(`drivers_calc2`.`P52` * `EffectivePeriodCalc`.`P52`) AS `P52`,(`drivers_calc2`.`P53` * `EffectivePeriodCalc`.`P53`) AS `P53`,(`drivers_calc2`.`P54` * `EffectivePeriodCalc`.`P54`) AS `P54`,(`drivers_calc2`.`P55` * `EffectivePeriodCalc`.`P55`) AS `P55`,(`drivers_calc2`.`P56` * `EffectivePeriodCalc`.`P56`) AS `P56`,(`drivers_calc2`.`P57` * `EffectivePeriodCalc`.`P57`) AS `P57`,(`drivers_calc2`.`P58` * `EffectivePeriodCalc`.`P58`) AS `P58`,(`drivers_calc2`.`P59` * `EffectivePeriodCalc`.`P59`) AS `P59`,(`drivers_calc2`.`P60` * `EffectivePeriodCalc`.`P60`) AS `P60` from ((`drivers_calc2` join `versions` on((`versions`.`FCSTDesc` = `drivers_calc2`.`FCSTDesc`))) join `EffectivePeriodCalc` on((`versions`.`effective_period_number` = `EffectivePeriodCalc`.`Effective_Period`)));
CREATE VIEW `master_fcst_new2` AS select `master_fcst_cons`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_cons`.`Mid4Desc` AS `StoreDesc`,`master_fcst_cons`.`AccountDesc` AS `AccountDesc`,sum(`master_fcst_cons`.`P1`) AS `P1`,sum(`master_fcst_cons`.`P2`) AS `P2`,sum(`master_fcst_cons`.`P3`) AS `P3`,sum(`master_fcst_cons`.`P4`) AS `P4`,sum(`master_fcst_cons`.`P5`) AS `P5`,sum(`master_fcst_cons`.`P6`) AS `P6`,sum(`master_fcst_cons`.`P7`) AS `P7`,sum(`master_fcst_cons`.`P8`) AS `P8`,sum(`master_fcst_cons`.`P9`) AS `P9`,sum(`master_fcst_cons`.`P10`) AS `P10`,sum(`master_fcst_cons`.`P11`) AS `P11`,sum(`master_fcst_cons`.`P12`) AS `P12`,sum(`master_fcst_cons`.`P13`) AS `P13`,sum(`master_fcst_cons`.`P14`) AS `P14`,sum(`master_fcst_cons`.`P15`) AS `P15`,sum(`master_fcst_cons`.`P16`) AS `P16`,sum(`master_fcst_cons`.`P17`) AS `P17`,sum(`master_fcst_cons`.`P18`) AS `P18`,sum(`master_fcst_cons`.`P19`) AS `P19`,sum(`master_fcst_cons`.`P20`) AS `P20`,sum(`master_fcst_cons`.`P21`) AS `P21`,sum(`master_fcst_cons`.`P22`) AS `P22`,sum(`master_fcst_cons`.`P23`) AS `P23`,sum(`master_fcst_cons`.`P24`) AS `P24`,sum(`master_fcst_cons`.`P25`) AS `P25`,sum(`master_fcst_cons`.`P26`) AS `P26`,sum(`master_fcst_cons`.`P27`) AS `P27`,sum(`master_fcst_cons`.`P28`) AS `P28`,sum(`master_fcst_cons`.`P29`) AS `P29`,sum(`master_fcst_cons`.`P30`) AS `P30`,sum(`master_fcst_cons`.`P31`) AS `P31`,sum(`master_fcst_cons`.`P32`) AS `P32`,sum(`master_fcst_cons`.`P33`) AS `P33`,sum(`master_fcst_cons`.`P34`) AS `P34`,sum(`master_fcst_cons`.`P35`) AS `P35`,sum(`master_fcst_cons`.`P36`) AS `P36`,sum(`master_fcst_cons`.`P37`) AS `P37`,sum(`master_fcst_cons`.`P38`) AS `P38`,sum(`master_fcst_cons`.`P39`) AS `P39`,sum(`master_fcst_cons`.`P40`) AS `P40`,sum(`master_fcst_cons`.`P41`) AS `P41`,sum(`master_fcst_cons`.`P42`) AS `P42`,sum(`master_fcst_cons`.`P43`) AS `P43`,sum(`master_fcst_cons`.`P44`) AS `P44`,sum(`master_fcst_cons`.`P45`) AS `P45`,sum(`master_fcst_cons`.`P46`) AS `P46`,sum(`master_fcst_cons`.`P47`) AS `P47`,sum(`master_fcst_cons`.`P48`) AS `P48`,sum(`master_fcst_cons`.`P49`) AS `P49`,sum(`master_fcst_cons`.`P50`) AS `P50`,sum(`master_fcst_cons`.`P51`) AS `P51`,sum(`master_fcst_cons`.`P52`) AS `P52`,sum(`master_fcst_cons`.`P53`) AS `P53`,sum(`master_fcst_cons`.`P54`) AS `P54`,sum(`master_fcst_cons`.`P55`) AS `P55`,sum(`master_fcst_cons`.`P56`) AS `P56`,sum(`master_fcst_cons`.`P57`) AS `P57`,sum(`master_fcst_cons`.`P58`) AS `P58`,sum(`master_fcst_cons`.`P59`) AS `P59`,sum(`master_fcst_cons`.`P60`) AS `P60` from `master_fcst_cons` group by `master_fcst_cons`.`FCSTDesc`,`master_fcst_cons`.`Mid4Desc`,`master_fcst_cons`.`AccountDesc`;
CREATE VIEW `master_fcst_web` AS select `master_fcst_cons`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_cons`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_cons`.`AccountDesc` AS `AccountDesc`,sum(`master_fcst_cons`.`P1`) AS `P1`,sum(`master_fcst_cons`.`P2`) AS `P2`,sum(`master_fcst_cons`.`P3`) AS `P3`,sum(`master_fcst_cons`.`P4`) AS `P4`,sum(`master_fcst_cons`.`P5`) AS `P5`,sum(`master_fcst_cons`.`P6`) AS `P6`,sum(`master_fcst_cons`.`P7`) AS `P7`,sum(`master_fcst_cons`.`P8`) AS `P8`,sum(`master_fcst_cons`.`P9`) AS `P9`,sum(`master_fcst_cons`.`P10`) AS `P10`,sum(`master_fcst_cons`.`P11`) AS `P11`,sum(`master_fcst_cons`.`P12`) AS `P12`,sum(`master_fcst_cons`.`P13`) AS `P13`,sum(`master_fcst_cons`.`P14`) AS `P14`,sum(`master_fcst_cons`.`P15`) AS `P15`,sum(`master_fcst_cons`.`P16`) AS `P16`,sum(`master_fcst_cons`.`P17`) AS `P17`,sum(`master_fcst_cons`.`P18`) AS `P18`,sum(`master_fcst_cons`.`P19`) AS `P19`,sum(`master_fcst_cons`.`P20`) AS `P20`,sum(`master_fcst_cons`.`P21`) AS `P21`,sum(`master_fcst_cons`.`P22`) AS `P22`,sum(`master_fcst_cons`.`P23`) AS `P23`,sum(`master_fcst_cons`.`P24`) AS `P24`,sum(`master_fcst_cons`.`P25`) AS `P25`,sum(`master_fcst_cons`.`P26`) AS `P26`,sum(`master_fcst_cons`.`P27`) AS `P27`,sum(`master_fcst_cons`.`P28`) AS `P28`,sum(`master_fcst_cons`.`P29`) AS `P29`,sum(`master_fcst_cons`.`P30`) AS `P30`,sum(`master_fcst_cons`.`P31`) AS `P31`,sum(`master_fcst_cons`.`P32`) AS `P32`,sum(`master_fcst_cons`.`P33`) AS `P33`,sum(`master_fcst_cons`.`P34`) AS `P34`,sum(`master_fcst_cons`.`P35`) AS `P35`,sum(`master_fcst_cons`.`P36`) AS `P36`,sum(`master_fcst_cons`.`P37`) AS `P37`,sum(`master_fcst_cons`.`P38`) AS `P38`,sum(`master_fcst_cons`.`P39`) AS `P39`,sum(`master_fcst_cons`.`P40`) AS `P40`,sum(`master_fcst_cons`.`P41`) AS `P41`,sum(`master_fcst_cons`.`P42`) AS `P42`,sum(`master_fcst_cons`.`P43`) AS `P43`,sum(`master_fcst_cons`.`P44`) AS `P44`,sum(`master_fcst_cons`.`P45`) AS `P45`,sum(`master_fcst_cons`.`P46`) AS `P46`,sum(`master_fcst_cons`.`P47`) AS `P47`,sum(`master_fcst_cons`.`P48`) AS `P48`,sum(`master_fcst_cons`.`P49`) AS `P49`,sum(`master_fcst_cons`.`P50`) AS `P50`,sum(`master_fcst_cons`.`P51`) AS `P51`,sum(`master_fcst_cons`.`P52`) AS `P52`,sum(`master_fcst_cons`.`P53`) AS `P53`,sum(`master_fcst_cons`.`P54`) AS `P54`,sum(`master_fcst_cons`.`P55`) AS `P55`,sum(`master_fcst_cons`.`P56`) AS `P56`,sum(`master_fcst_cons`.`P57`) AS `P57`,sum(`master_fcst_cons`.`P58`) AS `P58`,sum(`master_fcst_cons`.`P59`) AS `P59`,sum(`master_fcst_cons`.`P60`) AS `P60` from `master_fcst_cons` where (not(`master_fcst_cons`.`AccountDesc` in (select `acct_tree2`.`acct` AS `acct` from `acct_tree2` where (`acct_tree2`.`acct_type` = _latin1'manual')))) group by `master_fcst_cons`.`FCSTDesc`,`master_fcst_cons`.`Mid4Desc`,`master_fcst_cons`.`AccountDesc` union all select `master_fcst_manual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_manual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_manual`.`AccountDesc` AS `AccountDesc`,`master_fcst_manual`.`P1` AS `P1`,`master_fcst_manual`.`P2` AS `P2`,`master_fcst_manual`.`P3` AS `P3`,`master_fcst_manual`.`P4` AS `P4`,`master_fcst_manual`.`P5` AS `P5`,`master_fcst_manual`.`P6` AS `P6`,`master_fcst_manual`.`P7` AS `P7`,`master_fcst_manual`.`P8` AS `P8`,`master_fcst_manual`.`P9` AS `P9`,`master_fcst_manual`.`P10` AS `P10`,`master_fcst_manual`.`P11` AS `P11`,`master_fcst_manual`.`P12` AS `P12`,`master_fcst_manual`.`P13` AS `P13`,`master_fcst_manual`.`P14` AS `P14`,`master_fcst_manual`.`P15` AS `P15`,`master_fcst_manual`.`P16` AS `P16`,`master_fcst_manual`.`P17` AS `P17`,`master_fcst_manual`.`P18` AS `P18`,`master_fcst_manual`.`P19` AS `P19`,`master_fcst_manual`.`P20` AS `P20`,`master_fcst_manual`.`P21` AS `P21`,`master_fcst_manual`.`P22` AS `P22`,`master_fcst_manual`.`P23` AS `P23`,`master_fcst_manual`.`P24` AS `P24`,`master_fcst_manual`.`P25` AS `P25`,`master_fcst_manual`.`P26` AS `P26`,`master_fcst_manual`.`P27` AS `P27`,`master_fcst_manual`.`P28` AS `P28`,`master_fcst_manual`.`P29` AS `P29`,`master_fcst_manual`.`P30` AS `P30`,`master_fcst_manual`.`P31` AS `P31`,`master_fcst_manual`.`P32` AS `P32`,`master_fcst_manual`.`P33` AS `P33`,`master_fcst_manual`.`P34` AS `P34`,`master_fcst_manual`.`P35` AS `P35`,`master_fcst_manual`.`P36` AS `P36`,`master_fcst_manual`.`P37` AS `P37`,`master_fcst_manual`.`P38` AS `P38`,`master_fcst_manual`.`P39` AS `P39`,`master_fcst_manual`.`P40` AS `P40`,`master_fcst_manual`.`P41` AS `P41`,`master_fcst_manual`.`P42` AS `P42`,`master_fcst_manual`.`P43` AS `P43`,`master_fcst_manual`.`P44` AS `P44`,`master_fcst_manual`.`P45` AS `P45`,`master_fcst_manual`.`P46` AS `P46`,`master_fcst_manual`.`P47` AS `P47`,`master_fcst_manual`.`P48` AS `P48`,`master_fcst_manual`.`P49` AS `P49`,`master_fcst_manual`.`P50` AS `P50`,`master_fcst_manual`.`P51` AS `P51`,`master_fcst_manual`.`P52` AS `P52`,`master_fcst_manual`.`P53` AS `P53`,`master_fcst_manual`.`P54` AS `P54`,`master_fcst_manual`.`P55` AS `P55`,`master_fcst_manual`.`P56` AS `P56`,`master_fcst_manual`.`P57` AS `P57`,`master_fcst_manual`.`P58` AS `P58`,`master_fcst_manual`.`P59` AS `P59`,`master_fcst_manual`.`P60` AS `P60` from `master_fcst_manual`;
CREATE VIEW `parent_child` AS select `lev01`.`acct_id` AS `id_01`,`lev01`.`acct` AS `name_01`,`lev01`.`sort` AS `sort_01`,`lev02`.`acct_id` AS `id_02`,`lev02`.`acct` AS `name_02`,`lev02`.`sort` AS `sort_02`,`lev03`.`acct_id` AS `id_03`,`lev03`.`acct` AS `name_03`,`lev03`.`sort` AS `sort_03`,`lev04`.`acct_id` AS `id_04`,`lev04`.`acct` AS `name_04`,`lev04`.`sort` AS `sort_04`,`lev05`.`acct_id` AS `id_05`,`lev05`.`acct` AS `name_05`,`lev05`.`sort` AS `sort_05`,`lev06`.`acct_id` AS `id_06`,`lev06`.`acct` AS `name_06`,`lev06`.`sort` AS `sort_06`,`lev07`.`acct_id` AS `id_07`,`lev07`.`acct` AS `name_07`,`lev07`.`sort` AS `sort_07`,`lev08`.`acct_id` AS `id_08`,`lev08`.`acct` AS `name_08`,`lev08`.`sort` AS `sort_08`,`lev09`.`acct_id` AS `id_09`,`lev09`.`acct` AS `name_09`,`lev09`.`sort` AS `sort_09`,`lev10`.`acct_id` AS `id_10`,`lev10`.`acct` AS `name_10`,`lev10`.`sort` AS `sort_10`,if((`lev10`.`acct_id` is not null),`lev09`.`acct`,if((`lev09`.`acct_id` is not null),`lev08`.`acct`,if((`lev08`.`acct_id` is not null),`lev07`.`acct`,if((`lev07`.`acct_id` is not null),`lev06`.`acct`,if((`lev06`.`acct_id` is not null),`lev05`.`acct`,if((`lev05`.`acct_id` is not null),`lev04`.`acct`,if((`lev04`.`acct_id` is not null),`lev03`.`acct`,if((`lev03`.`acct_id` is not null),`lev02`.`acct`,if((`lev02`.`acct_id` is not null),`lev01`.`acct`,`lev01`.`acct`))))))))) AS `parent_final`,if((`lev10`.`acct_id` is not null),`lev10`.`acct`,if((`lev09`.`acct_id` is not null),`lev09`.`acct`,if((`lev08`.`acct_id` is not null),`lev08`.`acct`,if((`lev07`.`acct_id` is not null),`lev07`.`acct`,if((`lev06`.`acct_id` is not null),`lev06`.`acct`,if((`lev05`.`acct_id` is not null),`lev05`.`acct`,if((`lev04`.`acct_id` is not null),`lev04`.`acct`,if((`lev03`.`acct_id` is not null),`lev03`.`acct`,if((`lev02`.`acct_id` is not null),`lev02`.`acct`,`lev01`.`acct`))))))))) AS `acct`,if((`lev10`.`acct_id` is not null),`lev10`.`sort`,if((`lev09`.`acct_id` is not null),`lev09`.`sort`,if((`lev08`.`acct_id` is not null),`lev08`.`sort`,if((`lev07`.`acct_id` is not null),`lev07`.`sort`,if((`lev06`.`acct_id` is not null),`lev06`.`sort`,if((`lev05`.`acct_id` is not null),`lev05`.`sort`,if((`lev04`.`acct_id` is not null),`lev04`.`sort`,if((`lev03`.`acct_id` is not null),`lev03`.`sort`,if((`lev02`.`acct_id` is not null),`lev02`.`sort`,`lev01`.`sort`))))))))) AS `sort_final`,if((`lev10`.`acct_id` is not null),`lev10`.`acct_type`,if((`lev09`.`acct_id` is not null),`lev09`.`acct_type`,if((`lev08`.`acct_id` is not null),`lev08`.`acct_type`,if((`lev07`.`acct_id` is not null),`lev07`.`acct_type`,if((`lev06`.`acct_id` is not null),`lev06`.`acct_type`,if((`lev05`.`acct_id` is not null),`lev05`.`acct_type`,if((`lev04`.`acct_id` is not null),`lev04`.`acct_type`,if((`lev03`.`acct_id` is not null),`lev03`.`acct_type`,if((`lev02`.`acct_id` is not null),`lev02`.`acct_type`,`lev01`.`acct_type`))))))))) AS `acct_type_final` from (((((((((`acct_tree2` `lev01` left join `acct_tree2` `lev02` on((`lev01`.`acct_id` = `lev02`.`parent`))) left join `acct_tree2` `lev03` on((`lev02`.`acct_id` = `lev03`.`parent`))) left join `acct_tree2` `lev04` on((`lev03`.`acct_id` = `lev04`.`parent`))) left join `acct_tree2` `lev05` on((`lev04`.`acct_id` = `lev05`.`parent`))) left join `acct_tree2` `lev06` on((`lev05`.`acct_id` = `lev06`.`parent`))) left join `acct_tree2` `lev07` on((`lev06`.`acct_id` = `lev07`.`parent`))) left join `acct_tree2` `lev08` on((`lev07`.`acct_id` = `lev08`.`parent`))) left join `acct_tree2` `lev09` on((`lev08`.`acct_id` = `lev09`.`parent`))) left join `acct_tree2` `lev10` on((`lev09`.`acct_id` = `lev10`.`parent`))) where (`lev01`.`parent` = 0);
CREATE VIEW `parent_child_cc` AS select `lev01`.`acct_id` AS `id_01`,`lev01`.`acct` AS `name_01`,`lev01`.`sort` AS `sort_01`,`lev02`.`acct_id` AS `id_02`,`lev02`.`acct` AS `name_02`,`lev02`.`sort` AS `sort_02`,`lev03`.`acct_id` AS `id_03`,`lev03`.`acct` AS `name_03`,`lev03`.`sort` AS `sort_03`,`lev04`.`acct_id` AS `id_04`,`lev04`.`acct` AS `name_04`,`lev04`.`sort` AS `sort_04`,`lev05`.`acct_id` AS `id_05`,`lev05`.`acct` AS `name_05`,`lev05`.`sort` AS `sort_05`,`lev06`.`acct_id` AS `id_06`,`lev06`.`acct` AS `name_06`,`lev06`.`sort` AS `sort_06`,`lev07`.`acct_id` AS `id_07`,`lev07`.`acct` AS `name_07`,`lev07`.`sort` AS `sort_07`,`lev08`.`acct_id` AS `id_08`,`lev08`.`acct` AS `name_08`,`lev08`.`sort` AS `sort_08`,`lev09`.`acct_id` AS `id_09`,`lev09`.`acct` AS `name_09`,`lev09`.`sort` AS `sort_09`,`lev10`.`acct_id` AS `id_10`,`lev10`.`acct` AS `name_10`,`lev10`.`sort` AS `sort_10`,if((`lev10`.`acct_id` is not null),`lev09`.`acct`,if((`lev09`.`acct_id` is not null),`lev08`.`acct`,if((`lev08`.`acct_id` is not null),`lev07`.`acct`,if((`lev07`.`acct_id` is not null),`lev06`.`acct`,if((`lev06`.`acct_id` is not null),`lev05`.`acct`,if((`lev05`.`acct_id` is not null),`lev04`.`acct`,if((`lev04`.`acct_id` is not null),`lev03`.`acct`,if((`lev03`.`acct_id` is not null),`lev02`.`acct`,if((`lev02`.`acct_id` is not null),`lev01`.`acct`,`lev01`.`acct`))))))))) AS `parent_final`,if((`lev10`.`acct_id` is not null),`lev10`.`acct`,if((`lev09`.`acct_id` is not null),`lev09`.`acct`,if((`lev08`.`acct_id` is not null),`lev08`.`acct`,if((`lev07`.`acct_id` is not null),`lev07`.`acct`,if((`lev06`.`acct_id` is not null),`lev06`.`acct`,if((`lev05`.`acct_id` is not null),`lev05`.`acct`,if((`lev04`.`acct_id` is not null),`lev04`.`acct`,if((`lev03`.`acct_id` is not null),`lev03`.`acct`,if((`lev02`.`acct_id` is not null),`lev02`.`acct`,`lev01`.`acct`))))))))) AS `acct`,if((`lev10`.`acct_id` is not null),`lev10`.`sort`,if((`lev09`.`acct_id` is not null),`lev09`.`sort`,if((`lev08`.`acct_id` is not null),`lev08`.`sort`,if((`lev07`.`acct_id` is not null),`lev07`.`sort`,if((`lev06`.`acct_id` is not null),`lev06`.`sort`,if((`lev05`.`acct_id` is not null),`lev05`.`sort`,if((`lev04`.`acct_id` is not null),`lev04`.`sort`,if((`lev03`.`acct_id` is not null),`lev03`.`sort`,if((`lev02`.`acct_id` is not null),`lev02`.`sort`,`lev01`.`sort`))))))))) AS `sort_final` from (((((((((`costcenter_tree` `lev01` left join `costcenter_tree` `lev02` on((`lev01`.`acct_id` = `lev02`.`parent`))) left join `costcenter_tree` `lev03` on((`lev02`.`acct_id` = `lev03`.`parent`))) left join `costcenter_tree` `lev04` on((`lev03`.`acct_id` = `lev04`.`parent`))) left join `costcenter_tree` `lev05` on((`lev04`.`acct_id` = `lev05`.`parent`))) left join `costcenter_tree` `lev06` on((`lev05`.`acct_id` = `lev06`.`parent`))) left join `costcenter_tree` `lev07` on((`lev06`.`acct_id` = `lev07`.`parent`))) left join `costcenter_tree` `lev08` on((`lev07`.`acct_id` = `lev08`.`parent`))) left join `costcenter_tree` `lev09` on((`lev08`.`acct_id` = `lev09`.`parent`))) left join `costcenter_tree` `lev10` on((`lev09`.`acct_id` = `lev10`.`parent`))) where (`lev01`.`parent` = 0);
CREATE VIEW `Parent_Final3_cc_new` AS select `at2`.`acct_id` AS `acct_id`,`at2`.`acct` AS `acct`,`at2`.`acct` AS `acctdesc`,`at2`.`parent` AS `parent`,`at2`.`sort` AS `sort`,`at2`.`acct_type` AS `cc_type`,if((`pc`.`name_01` = `at2`.`acctdesc`),NULL,`pc`.`name_01`) AS `Parent1`,if((`pc`.`name_02` = `at2`.`acctdesc`),NULL,`pc`.`name_02`) AS `Parent2`,if((`pc`.`name_03` = `at2`.`acctdesc`),NULL,`pc`.`name_03`) AS `Parent3`,if((`pc`.`name_04` = `at2`.`acctdesc`),NULL,`pc`.`name_04`) AS `Parent4`,if((`pc`.`name_05` = `at2`.`acctdesc`),NULL,`pc`.`name_05`) AS `Parent5`,if((`pc`.`name_06` = `at2`.`acctdesc`),NULL,`pc`.`name_06`) AS `Parent6`,if((`pc`.`name_07` = `at2`.`acctdesc`),NULL,`pc`.`name_07`) AS `Parent7`,`pc`.`parent_final` AS `Parent_Final`,if((`pc`.`name_01` = `at2`.`acctdesc`),NULL,`pc`.`sort_01`) AS `sort1`,if((`pc`.`name_02` = `at2`.`acctdesc`),NULL,`pc`.`sort_02`) AS `sort2`,if((`pc`.`name_03` = `at2`.`acctdesc`),NULL,`pc`.`sort_03`) AS `sort3`,if((`pc`.`name_04` = `at2`.`acctdesc`),NULL,`pc`.`sort_04`) AS `sort4`,if((`pc`.`name_05` = `at2`.`acctdesc`),NULL,`pc`.`sort_05`) AS `sort5`,if((`pc`.`name_06` = `at2`.`acctdesc`),NULL,`pc`.`sort_06`) AS `sort6`,if((`pc`.`name_07` = `at2`.`acctdesc`),NULL,`pc`.`sort_07`) AS `sort7`,`pc`.`sort_final` AS `sort_Final` from (`parent_child_cc` `pc` join `costcenter_tree` `at2` on((`pc`.`acct` = `at2`.`acct`)));
CREATE VIEW `Parent_Final4_new` AS select `at2`.`acct_id` AS `acct_id`,`at2`.`acct` AS `acct`,`at2`.`acctdesc` AS `acctdesc`,`at2`.`parent` AS `parent`,`at2`.`sort` AS `sort`,`at2`.`applies_to` AS `applies_to`,`at2`.`impacts` AS `impacts`,`pc`.`name_01` AS `Parent1`,`pc`.`name_02` AS `Parent2`,`pc`.`name_03` AS `Parent3`,`pc`.`name_04` AS `Parent4`,`pc`.`name_05` AS `Parent5`,`pc`.`name_06` AS `Parent6`,`pc`.`name_07` AS `Parent7`,`pc`.`parent_final` AS `Parent_Final`,`pc`.`sort_01` AS `sort1`,`pc`.`sort_02` AS `sort2`,`pc`.`sort_03` AS `sort3`,`pc`.`sort_04` AS `sort4`,`pc`.`sort_05` AS `sort5`,`pc`.`sort_06` AS `sort6`,`pc`.`sort_07` AS `sort7`,`pc`.`sort_final` AS `sort_Final`,`pc`.`acct_type_final` AS `acct_type_final` from (`parent_child` `pc` join `acct_tree2` `at2` on((`pc`.`acct` = `at2`.`acct`)));
CREATE VIEW `PL_Detail` AS select `acct_tree2`.`Detail P-L` AS `P-L Group`,`master_fcst_web`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_web`.`FCSTDesc` AS `FCSTDesc`,sum(`master_fcst_web`.`P1`) AS `sum(``master_fcst_web``.``P1``)`,sum(`master_fcst_web`.`P2`) AS `sum(``master_fcst_web``.``P2``)`,sum(`master_fcst_web`.`P3`) AS `sum(``master_fcst_web``.``P3``)`,sum(`master_fcst_web`.`P4`) AS `sum(``master_fcst_web``.``P4``)`,sum(`master_fcst_web`.`P5`) AS `sum(``master_fcst_web``.``P5``)`,sum(`master_fcst_web`.`P6`) AS `sum(``master_fcst_web``.``P6``)`,sum(`master_fcst_web`.`P7`) AS `sum(``master_fcst_web``.``P7``)`,sum(`master_fcst_web`.`P8`) AS `sum(``master_fcst_web``.``P8``)`,sum(`master_fcst_web`.`P9`) AS `sum(``master_fcst_web``.``P9``)`,sum(`master_fcst_web`.`P10`) AS `sum(``master_fcst_web``.``P10``)`,sum(`master_fcst_web`.`P11`) AS `sum(``master_fcst_web``.``P11``)`,sum(`master_fcst_web`.`P12`) AS `sum(``master_fcst_web``.``P12``)`,sum(`master_fcst_web`.`P13`) AS `sum(``master_fcst_web``.``P13``)`,sum(`master_fcst_web`.`P14`) AS `sum(``master_fcst_web``.``P14``)`,sum(`master_fcst_web`.`P15`) AS `sum(``master_fcst_web``.``P15``)`,sum(`master_fcst_web`.`P16`) AS `sum(``master_fcst_web``.``P16``)`,sum(`master_fcst_web`.`P17`) AS `sum(``master_fcst_web``.``P17``)`,sum(`master_fcst_web`.`P18`) AS `sum(``master_fcst_web``.``P18``)`,sum(`master_fcst_web`.`P19`) AS `sum(``master_fcst_web``.``P19``)`,sum(`master_fcst_web`.`P20`) AS `sum(``master_fcst_web``.``P20``)`,sum(`master_fcst_web`.`P21`) AS `sum(``master_fcst_web``.``P21``)`,sum(`master_fcst_web`.`P22`) AS `sum(``master_fcst_web``.``P22``)`,sum(`master_fcst_web`.`P23`) AS `sum(``master_fcst_web``.``P23``)`,sum(`master_fcst_web`.`P24`) AS `sum(``master_fcst_web``.``P24``)`,sum(`master_fcst_web`.`P25`) AS `sum(``master_fcst_web``.``P25``)`,sum(`master_fcst_web`.`P26`) AS `sum(``master_fcst_web``.``P26``)`,sum(`master_fcst_web`.`P27`) AS `sum(``master_fcst_web``.``P27``)`,sum(`master_fcst_web`.`P28`) AS `sum(``master_fcst_web``.``P28``)`,sum(`master_fcst_web`.`P29`) AS `sum(``master_fcst_web``.``P29``)`,sum(`master_fcst_web`.`P30`) AS `sum(``master_fcst_web``.``P30``)`,sum(`master_fcst_web`.`P31`) AS `sum(``master_fcst_web``.``P31``)`,sum(`master_fcst_web`.`P32`) AS `sum(``master_fcst_web``.``P32``)`,sum(`master_fcst_web`.`P33`) AS `sum(``master_fcst_web``.``P33``)`,sum(`master_fcst_web`.`P34`) AS `sum(``master_fcst_web``.``P34``)`,sum(`master_fcst_web`.`P35`) AS `sum(``master_fcst_web``.``P35``)`,sum(`master_fcst_web`.`P36`) AS `sum(``master_fcst_web``.``P36``)` from (`acct_tree2` left join `master_fcst_web` on((convert(`acct_tree2`.`acct` using utf8) = `master_fcst_web`.`AccountDesc`))) group by `acct_tree2`.`Detail P-L`,`master_fcst_web`.`Mid4Desc`,`master_fcst_web`.`FCSTDesc`;
CREATE VIEW `pldetailpivot` AS select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P1' AS `Period`,`master_fcst_actual`.`P1` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P1` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P2' AS `Period`,`master_fcst_actual`.`P2` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P2` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P3' AS `Period`,`master_fcst_actual`.`P3` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P3` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P4' AS `Period`,`master_fcst_actual`.`P4` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P4` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P5' AS `Period`,`master_fcst_actual`.`P5` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P5` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P6' AS `Period`,`master_fcst_actual`.`P6` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P6` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P7' AS `Period`,`master_fcst_actual`.`P7` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P7` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P8' AS `Period`,`master_fcst_actual`.`P8` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P8` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P9' AS `Period`,`master_fcst_actual`.`P9` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P9` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P10' AS `Period`,`master_fcst_actual`.`P10` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P10` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P11' AS `Period`,`master_fcst_actual`.`P11` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P11` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P12' AS `Period`,`master_fcst_actual`.`P12` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P12` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P13' AS `Period`,`master_fcst_actual`.`P13` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P13` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P14' AS `Period`,`master_fcst_actual`.`P14` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P14` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P15' AS `Period`,`master_fcst_actual`.`P15` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P15` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P16' AS `Period`,`master_fcst_actual`.`P16` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P16` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P17' AS `Period`,`master_fcst_actual`.`P17` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P17` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P18' AS `Period`,`master_fcst_actual`.`P18` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P18` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P19' AS `Period`,`master_fcst_actual`.`P19` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P19` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P20' AS `Period`,`master_fcst_actual`.`P20` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P20` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P21' AS `Period`,`master_fcst_actual`.`P21` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P21` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P22' AS `Period`,`master_fcst_actual`.`P22` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P22` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P23' AS `Period`,`master_fcst_actual`.`P23` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P23` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P24' AS `Period`,`master_fcst_actual`.`P24` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P24` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P25' AS `Period`,`master_fcst_actual`.`P25` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P25` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P26' AS `Period`,`master_fcst_actual`.`P26` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P26` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P27' AS `Period`,`master_fcst_actual`.`P27` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P27` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P28' AS `Period`,`master_fcst_actual`.`P28` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P28` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P29' AS `Period`,`master_fcst_actual`.`P29` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P29` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P30' AS `Period`,`master_fcst_actual`.`P30` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P30` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P31' AS `Period`,`master_fcst_actual`.`P31` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P31` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P32' AS `Period`,`master_fcst_actual`.`P32` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P32` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P33' AS `Period`,`master_fcst_actual`.`P33` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P33` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P34' AS `Period`,`master_fcst_actual`.`P34` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P34` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P35' AS `Period`,`master_fcst_actual`.`P35` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P35` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P36' AS `Period`,`master_fcst_actual`.`P36` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P36` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P37' AS `Period`,`master_fcst_actual`.`P37` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P37` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P38' AS `Period`,`master_fcst_actual`.`P38` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P38` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P39' AS `Period`,`master_fcst_actual`.`P39` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P39` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P40' AS `Period`,`master_fcst_actual`.`P40` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P40` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P41' AS `Period`,`master_fcst_actual`.`P41` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P41` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P42' AS `Period`,`master_fcst_actual`.`P42` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P42` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P43' AS `Period`,`master_fcst_actual`.`P43` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P43` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P44' AS `Period`,`master_fcst_actual`.`P44` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P44` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P45' AS `Period`,`master_fcst_actual`.`P45` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P45` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P46' AS `Period`,`master_fcst_actual`.`P46` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P46` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P47' AS `Period`,`master_fcst_actual`.`P47` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P47` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P48' AS `Period`,`master_fcst_actual`.`P48` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P48` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P49' AS `Period`,`master_fcst_actual`.`P49` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P49` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P50' AS `Period`,`master_fcst_actual`.`P50` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P50` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P51' AS `Period`,`master_fcst_actual`.`P51` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P51` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P52' AS `Period`,`master_fcst_actual`.`P52` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P52` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P53' AS `Period`,`master_fcst_actual`.`P53` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P53` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P54' AS `Period`,`master_fcst_actual`.`P54` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P54` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P55' AS `Period`,`master_fcst_actual`.`P55` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P55` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P56' AS `Period`,`master_fcst_actual`.`P56` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P56` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P57' AS `Period`,`master_fcst_actual`.`P57` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P57` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P58' AS `Period`,`master_fcst_actual`.`P58` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P58` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P59' AS `Period`,`master_fcst_actual`.`P59` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P59` <> 0) union select `master_fcst_actual`.`FCSTDesc` AS `FCSTDesc`,`master_fcst_actual`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_actual`.`AccountDesc` AS `AccountDesc`,'P60' AS `Period`,`master_fcst_actual`.`P60` AS `amount` from `master_fcst_actual` where (`master_fcst_actual`.`P60` <> 0);
CREATE VIEW `PL_rollups` AS select `acct_tree2`.`P-L Group` AS `P-L Group`,`master_fcst_web`.`Mid4Desc` AS `Mid4Desc`,`master_fcst_web`.`FCSTDesc` AS `FCSTDesc`,sum(`master_fcst_web`.`P1`) AS `sum(``master_fcst_web``.``P1``)`,sum(`master_fcst_web`.`P2`) AS `sum(``master_fcst_web``.``P2``)`,sum(`master_fcst_web`.`P3`) AS `sum(``master_fcst_web``.``P3``)`,sum(`master_fcst_web`.`P4`) AS `sum(``master_fcst_web``.``P4``)`,sum(`master_fcst_web`.`P5`) AS `sum(``master_fcst_web``.``P5``)`,sum(`master_fcst_web`.`P6`) AS `sum(``master_fcst_web``.``P6``)`,sum(`master_fcst_web`.`P7`) AS `sum(``master_fcst_web``.``P7``)`,sum(`master_fcst_web`.`P8`) AS `sum(``master_fcst_web``.``P8``)`,sum(`master_fcst_web`.`P9`) AS `sum(``master_fcst_web``.``P9``)`,sum(`master_fcst_web`.`P10`) AS `sum(``master_fcst_web``.``P10``)`,sum(`master_fcst_web`.`P11`) AS `sum(``master_fcst_web``.``P11``)`,sum(`master_fcst_web`.`P12`) AS `sum(``master_fcst_web``.``P12``)`,sum(`master_fcst_web`.`P13`) AS `sum(``master_fcst_web``.``P13``)`,sum(`master_fcst_web`.`P14`) AS `sum(``master_fcst_web``.``P14``)`,sum(`master_fcst_web`.`P15`) AS `sum(``master_fcst_web``.``P15``)`,sum(`master_fcst_web`.`P16`) AS `sum(``master_fcst_web``.``P16``)`,sum(`master_fcst_web`.`P17`) AS `sum(``master_fcst_web``.``P17``)`,sum(`master_fcst_web`.`P18`) AS `sum(``master_fcst_web``.``P18``)`,sum(`master_fcst_web`.`P19`) AS `sum(``master_fcst_web``.``P19``)`,sum(`master_fcst_web`.`P20`) AS `sum(``master_fcst_web``.``P20``)`,sum(`master_fcst_web`.`P21`) AS `sum(``master_fcst_web``.``P21``)`,sum(`master_fcst_web`.`P22`) AS `sum(``master_fcst_web``.``P22``)`,sum(`master_fcst_web`.`P23`) AS `sum(``master_fcst_web``.``P23``)`,sum(`master_fcst_web`.`P24`) AS `sum(``master_fcst_web``.``P24``)`,sum(`master_fcst_web`.`P25`) AS `sum(``master_fcst_web``.``P25``)`,sum(`master_fcst_web`.`P26`) AS `sum(``master_fcst_web``.``P26``)`,sum(`master_fcst_web`.`P27`) AS `sum(``master_fcst_web``.``P27``)`,sum(`master_fcst_web`.`P28`) AS `sum(``master_fcst_web``.``P28``)`,sum(`master_fcst_web`.`P29`) AS `sum(``master_fcst_web``.``P29``)`,sum(`master_fcst_web`.`P30`) AS `sum(``master_fcst_web``.``P30``)`,sum(`master_fcst_web`.`P31`) AS `sum(``master_fcst_web``.``P31``)`,sum(`master_fcst_web`.`P32`) AS `sum(``master_fcst_web``.``P32``)`,sum(`master_fcst_web`.`P33`) AS `sum(``master_fcst_web``.``P33``)`,sum(`master_fcst_web`.`P34`) AS `sum(``master_fcst_web``.``P34``)`,sum(`master_fcst_web`.`P35`) AS `sum(``master_fcst_web``.``P35``)`,sum(`master_fcst_web`.`P36`) AS `sum(``master_fcst_web``.``P36``)`,sum(`master_fcst_web`.`P37`) AS `sum(``master_fcst_web``.``P37``)`,sum(`master_fcst_web`.`P38`) AS `sum(``master_fcst_web``.``P38``)`,sum(`master_fcst_web`.`P39`) AS `sum(``master_fcst_web``.``P39``)`,sum(`master_fcst_web`.`P40`) AS `sum(``master_fcst_web``.``P40``)`,sum(`master_fcst_web`.`P41`) AS `sum(``master_fcst_web``.``P41``)`,sum(`master_fcst_web`.`P42`) AS `sum(``master_fcst_web``.``P42``)`,sum(`master_fcst_web`.`P43`) AS `sum(``master_fcst_web``.``P43``)`,sum(`master_fcst_web`.`P44`) AS `sum(``master_fcst_web``.``P44``)`,sum(`master_fcst_web`.`P45`) AS `sum(``master_fcst_web``.``P45``)`,sum(`master_fcst_web`.`P46`) AS `sum(``master_fcst_web``.``P46``)`,sum(`master_fcst_web`.`P47`) AS `sum(``master_fcst_web``.``P47``)`,sum(`master_fcst_web`.`P48`) AS `sum(``master_fcst_web``.``P48``)` from (`acct_tree2` left join `master_fcst_web` on((convert(`acct_tree2`.`acct` using utf8) = `master_fcst_web`.`AccountDesc`))) group by `acct_tree2`.`P-L Group`,`master_fcst_web`.`Mid4Desc`,`master_fcst_web`.`FCSTDesc`;
CREATE VIEW `qboactualsinsert` AS select 'actuals' AS `FCSTDesc`,'maple_lawn' AS `Mid4Desc`,trim(`qboplimporta`.`Account`) AS `account`,if(isnull(`qboplimporta`.`1`),0,`qboplimporta`.`1`) AS `P1`,if(isnull(`qboplimporta`.`2`),0,`qboplimporta`.`2`) AS `P2`,if(isnull(`qboplimporta`.`3`),0,`qboplimporta`.`3`) AS `P3`,if(isnull(`qboplimporta`.`4`),0,`qboplimporta`.`4`) AS `P4`,if(isnull(`qboplimporta`.`5`),0,`qboplimporta`.`5`) AS `P5`,if(isnull(`qboplimporta`.`6`),0,`qboplimporta`.`6`) AS `P6`,if(isnull(`qboplimporta`.`7`),0,`qboplimporta`.`7`) AS `P7`,if(isnull(`qboplimporta`.`8`),0,`qboplimporta`.`8`) AS `P8`,if(isnull(`qboplimporta`.`9`),0,`qboplimporta`.`9`) AS `P9`,if(isnull(`qboplimporta`.`10`),0,`qboplimporta`.`10`) AS `P10`,if(isnull(`qboplimporta`.`11`),0,`qboplimporta`.`11`) AS `P11`,if(isnull(`qboplimporta`.`12`),0,`qboplimporta`.`12`) AS `P12`,if(isnull(`qboplimporta`.`13`),0,`qboplimporta`.`13`) AS `P13`,if(isnull(`qboplimporta`.`14`),0,`qboplimporta`.`14`) AS `P14`,if(isnull(`qboplimporta`.`15`),0,`qboplimporta`.`15`) AS `P15`,if(isnull(`qboplimporta`.`16`),0,`qboplimporta`.`16`) AS `P16`,if(isnull(`qboplimporta`.`17`),0,`qboplimporta`.`17`) AS `P17`,if(isnull(`qboplimporta`.`18`),0,`qboplimporta`.`18`) AS `P18`,if(isnull(`qboplimporta`.`19`),0,`qboplimporta`.`19`) AS `P19`,if(isnull(`qboplimporta`.`20`),0,`qboplimporta`.`20`) AS `P20`,if(isnull(`qboplimporta`.`21`),0,`qboplimporta`.`21`) AS `P21`,if(isnull(`qboplimporta`.`22`),0,`qboplimporta`.`22`) AS `P22`,if(isnull(`qboplimporta`.`23`),0,`qboplimporta`.`23`) AS `P23`,if(isnull(`qboplimporta`.`24`),0,`qboplimporta`.`24`) AS `P24`,if(isnull(`qboplimporta`.`25`),0,`qboplimporta`.`25`) AS `P25`,if(isnull(`qboplimporta`.`26`),0,`qboplimporta`.`26`) AS `P26`,if(isnull(`qboplimporta`.`27`),0,`qboplimporta`.`27`) AS `P27`,if(isnull(`qboplimporta`.`28`),0,`qboplimporta`.`28`) AS `P28`,if(isnull(`qboplimporta`.`29`),0,`qboplimporta`.`29`) AS `P29`,if(isnull(`qboplimporta`.`30`),0,`qboplimporta`.`30`) AS `P30`,if(isnull(`qboplimporta`.`31`),0,`qboplimporta`.`31`) AS `P31`,if(isnull(`qboplimporta`.`32`),0,`qboplimporta`.`32`) AS `P32`,if(isnull(`qboplimporta`.`33`),0,`qboplimporta`.`33`) AS `P33`,if(isnull(`qboplimporta`.`34`),0,`qboplimporta`.`34`) AS `P34`,if(isnull(`qboplimporta`.`35`),0,`qboplimporta`.`35`) AS `P35`,if(isnull(`qboplimporta`.`36`),0,`qboplimporta`.`36`) AS `P36`,if(isnull(`qboplimporta`.`37`),0,`qboplimporta`.`37`) AS `P37`,if(isnull(`qboplimporta`.`38`),0,`qboplimporta`.`38`) AS `P38`,if(isnull(`qboplimporta`.`39`),0,`qboplimporta`.`39`) AS `P39`,if(isnull(`qboplimporta`.`40`),0,`qboplimporta`.`40`) AS `P40`,if(isnull(`qboplimporta`.`41`),0,`qboplimporta`.`41`) AS `P41`,if(isnull(`qboplimporta`.`42`),0,`qboplimporta`.`42`) AS `P42`,if(isnull(`qboplimporta`.`43`),0,`qboplimporta`.`43`) AS `P43`,if(isnull(`qboplimporta`.`44`),0,`qboplimporta`.`44`) AS `P44`,if(isnull(`qboplimporta`.`45`),0,`qboplimporta`.`45`) AS `P45`,if(isnull(`qboplimporta`.`46`),0,`qboplimporta`.`46`) AS `P46`,if(isnull(`qboplimporta`.`47`),0,`qboplimporta`.`47`) AS `P47`,if(isnull(`qboplimporta`.`48`),0,`qboplimporta`.`48`) AS `P48`,if(isnull(`qboplimporta`.`49`),0,`qboplimporta`.`49`) AS `P49`,if(isnull(`qboplimporta`.`50`),0,`qboplimporta`.`50`) AS `P50`,if(isnull(`qboplimporta`.`41`),0,`qboplimporta`.`51`) AS `P51`,if(isnull(`qboplimporta`.`52`),0,`qboplimporta`.`52`) AS `P52`,if(isnull(`qboplimporta`.`53`),0,`qboplimporta`.`53`) AS `P53`,if(isnull(`qboplimporta`.`54`),0,`qboplimporta`.`54`) AS `P54`,if(isnull(`qboplimporta`.`55`),0,`qboplimporta`.`55`) AS `P55`,if(isnull(`qboplimporta`.`56`),0,`qboplimporta`.`56`) AS `P56`,if(isnull(`qboplimporta`.`57`),0,`qboplimporta`.`57`) AS `P57`,if(isnull(`qboplimporta`.`58`),0,`qboplimporta`.`58`) AS `P58`,if(isnull(`qboplimporta`.`59`),0,`qboplimporta`.`59`) AS `P59`,if(isnull(`qboplimporta`.`60`),0,`qboplimporta`.`60`) AS `P60`,NULL AS `id` from (`qboplimporta` join `acct_tree2` on((trim(`qboplimporta`.`Account`) = convert(`acct_tree2`.`acct` using utf8)))) where (`acct_tree2`.`acct_type` <> 'rollup') union all select 'actuals' AS `FCSTDesc`,'perry_hall' AS `Mid4Desc`,trim(`qboplimportb`.`Account`) AS `account`,if(isnull(`qboplimportb`.`1`),0,`qboplimportb`.`1`) AS `P1`,if(isnull(`qboplimportb`.`2`),0,`qboplimportb`.`2`) AS `P2`,if(isnull(`qboplimportb`.`3`),0,`qboplimportb`.`3`) AS `P3`,if(isnull(`qboplimportb`.`4`),0,`qboplimportb`.`4`) AS `P4`,if(isnull(`qboplimportb`.`5`),0,`qboplimportb`.`5`) AS `P5`,if(isnull(`qboplimportb`.`6`),0,`qboplimportb`.`6`) AS `P6`,if(isnull(`qboplimportb`.`7`),0,`qboplimportb`.`7`) AS `P7`,if(isnull(`qboplimportb`.`8`),0,`qboplimportb`.`8`) AS `P8`,if(isnull(`qboplimportb`.`9`),0,`qboplimportb`.`9`) AS `P9`,if(isnull(`qboplimportb`.`10`),0,`qboplimportb`.`10`) AS `P10`,if(isnull(`qboplimportb`.`11`),0,`qboplimportb`.`11`) AS `P11`,if(isnull(`qboplimportb`.`12`),0,`qboplimportb`.`12`) AS `P12`,if(isnull(`qboplimportb`.`13`),0,`qboplimportb`.`13`) AS `P13`,if(isnull(`qboplimportb`.`14`),0,`qboplimportb`.`14`) AS `P14`,if(isnull(`qboplimportb`.`15`),0,`qboplimportb`.`15`) AS `P15`,if(isnull(`qboplimportb`.`16`),0,`qboplimportb`.`16`) AS `P16`,if(isnull(`qboplimportb`.`17`),0,`qboplimportb`.`17`) AS `P17`,if(isnull(`qboplimportb`.`18`),0,`qboplimportb`.`18`) AS `P18`,if(isnull(`qboplimportb`.`19`),0,`qboplimportb`.`19`) AS `P19`,if(isnull(`qboplimportb`.`20`),0,`qboplimportb`.`20`) AS `P20`,if(isnull(`qboplimportb`.`21`),0,`qboplimportb`.`21`) AS `P21`,if(isnull(`qboplimportb`.`22`),0,`qboplimportb`.`22`) AS `P22`,if(isnull(`qboplimportb`.`23`),0,`qboplimportb`.`23`) AS `P23`,if(isnull(`qboplimportb`.`24`),0,`qboplimportb`.`24`) AS `P24`,if(isnull(`qboplimportb`.`25`),0,`qboplimportb`.`25`) AS `P25`,if(isnull(`qboplimportb`.`26`),0,`qboplimportb`.`26`) AS `P26`,if(isnull(`qboplimportb`.`27`),0,`qboplimportb`.`27`) AS `P27`,if(isnull(`qboplimportb`.`28`),0,`qboplimportb`.`28`) AS `P28`,if(isnull(`qboplimportb`.`29`),0,`qboplimportb`.`29`) AS `P29`,if(isnull(`qboplimportb`.`30`),0,`qboplimportb`.`30`) AS `P30`,if(isnull(`qboplimportb`.`31`),0,`qboplimportb`.`31`) AS `P31`,if(isnull(`qboplimportb`.`32`),0,`qboplimportb`.`32`) AS `P32`,if(isnull(`qboplimportb`.`33`),0,`qboplimportb`.`33`) AS `P33`,if(isnull(`qboplimportb`.`34`),0,`qboplimportb`.`34`) AS `P34`,if(isnull(`qboplimportb`.`35`),0,`qboplimportb`.`35`) AS `P35`,if(isnull(`qboplimportb`.`36`),0,`qboplimportb`.`36`) AS `P36`,if(isnull(`qboplimportb`.`37`),0,`qboplimportb`.`37`) AS `P37`,if(isnull(`qboplimportb`.`38`),0,`qboplimportb`.`38`) AS `P38`,if(isnull(`qboplimportb`.`39`),0,`qboplimportb`.`39`) AS `P39`,if(isnull(`qboplimportb`.`40`),0,`qboplimportb`.`40`) AS `P40`,if(isnull(`qboplimportb`.`41`),0,`qboplimportb`.`41`) AS `P41`,if(isnull(`qboplimportb`.`42`),0,`qboplimportb`.`42`) AS `P42`,if(isnull(`qboplimportb`.`43`),0,`qboplimportb`.`43`) AS `P43`,if(isnull(`qboplimportb`.`44`),0,`qboplimportb`.`44`) AS `P44`,if(isnull(`qboplimportb`.`45`),0,`qboplimportb`.`45`) AS `P45`,if(isnull(`qboplimportb`.`46`),0,`qboplimportb`.`46`) AS `P46`,if(isnull(`qboplimportb`.`47`),0,`qboplimportb`.`47`) AS `P47`,if(isnull(`qboplimportb`.`48`),0,`qboplimportb`.`48`) AS `P48`,if(isnull(`qboplimportb`.`49`),0,`qboplimportb`.`49`) AS `P49`,if(isnull(`qboplimportb`.`50`),0,`qboplimportb`.`50`) AS `P50`,if(isnull(`qboplimportb`.`41`),0,`qboplimportb`.`51`) AS `P51`,if(isnull(`qboplimportb`.`52`),0,`qboplimportb`.`52`) AS `P52`,if(isnull(`qboplimportb`.`53`),0,`qboplimportb`.`53`) AS `P53`,if(isnull(`qboplimportb`.`54`),0,`qboplimportb`.`54`) AS `P54`,if(isnull(`qboplimportb`.`55`),0,`qboplimportb`.`55`) AS `P55`,if(isnull(`qboplimportb`.`56`),0,`qboplimportb`.`56`) AS `P56`,if(isnull(`qboplimportb`.`57`),0,`qboplimportb`.`57`) AS `P57`,if(isnull(`qboplimportb`.`58`),0,`qboplimportb`.`58`) AS `P58`,if(isnull(`qboplimportb`.`59`),0,`qboplimportb`.`59`) AS `P59`,if(isnull(`qboplimportb`.`60`),0,`qboplimportb`.`60`) AS `P60`,NULL AS `id` from (`qboplimportb` join `acct_tree2` on((trim(`qboplimportb`.`Account`) = convert(`acct_tree2`.`acct` using utf8)))) where (`acct_tree2`.`acct_type` <> 'rollup');
SQL;
        DB::connection('tenant')->getPdo()->exec($sql);
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {

    }
}
